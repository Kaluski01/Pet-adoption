!function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/__assets/",n(n.s=388)}({106:function(e,t,n){"use strict";function i(){const e=document.documentElement,t=document.body;return{width:e.clientWidth||t.clientWidth,height:window.innerHeight}}n.d(t,"a",(function(){return i}))},124:function(e,t,n){"use strict";var i;!function(s){function o(e,t,n){var i,s,o,r,p,m,v,O,k,w=0,y=[],I=0,_=!1,S=[],E=[],A=!1;if(i=(n=n||{}).encoding||"UTF8",(k=n.numRounds||1)!==parseInt(k,10)||1>k)throw Error("numRounds must a integer >= 1");if("SHA-1"!==e)throw Error("Chosen SHA variant is not supported");p=512,m=b,v=T,r=160,O=function(e){return e.slice()},o=d(t,i),s=g(e),this.setHMACKey=function(t,n,o){var a;if(!0===_)throw Error("HMAC key already set");if(!0===A)throw Error("Cannot set HMAC key after calling update");for(t=(n=d(n,i=(o||{}).encoding||"UTF8")(t)).binLen,n=n.value,o=(a=p>>>3)/4-1,a<t/8&&(n=v(n,t,0,g(e),r));n.length<=o;)n.push(0);for(t=0;t<=o;t+=1)S[t]=909522486^n[t],E[t]=1549556828^n[t];s=m(S,s),w=p,_=!0},this.update=function(e){var t,n,i,r=0,a=p>>>5;for(e=(t=o(e,y,I)).binLen,n=t.value,t=e>>>5,i=0;i<t;i+=a)r+p<=e&&(s=m(n.slice(i,i+a),s),r+=p);w+=r,y=n.slice(r>>>5),I=e%p,A=!0},this.getHash=function(t,n){var i,o,d,p;if(!0===_)throw Error("Cannot call getHash after setting HMAC key");switch(d=f(n),t){case"HEX":i=function(e){return a(e,r,d)};break;case"B64":i=function(e){return u(e,r,d)};break;case"BYTES":i=function(e){return c(e,r)};break;case"ARRAYBUFFER":try{o=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}i=function(e){return h(e,r)};break;case"UINT8ARRAY":try{o=new Uint8Array(0)}catch(e){throw Error("UINT8ARRAY not supported by this environment")}i=function(e){return l(e,r)};break;default:throw Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}for(p=v(y.slice(),I,w,O(s),r),o=1;o<k;o+=1)p=v(p,r,0,g(e),r);return i(p)},this.getHMAC=function(t,n){var i,o,d,b;if(!1===_)throw Error("Cannot call getHMAC without first setting HMAC key");switch(d=f(n),t){case"HEX":i=function(e){return a(e,r,d)};break;case"B64":i=function(e){return u(e,r,d)};break;case"BYTES":i=function(e){return c(e,r)};break;case"ARRAYBUFFER":try{i=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}i=function(e){return h(e,r)};break;case"UINT8ARRAY":try{i=new Uint8Array(0)}catch(e){throw Error("UINT8ARRAY not supported by this environment")}i=function(e){return l(e,r)};break;default:throw Error("outputFormat must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}return o=v(y.slice(),I,w,O(s),r),b=m(E,g(e)),i(b=v(o,r,p,b,r))}}function r(e,t,n){var i,s,o,r;for(t=t||[0],s=(n=n||0)>>>3,i=0;i<e.length;i+=1)o=(r=i+s)>>>2,t.length<=o&&t.push(0),t[o]|=e[i]<<8*(3+r%4*-1);return{value:t,binLen:8*e.length+n}}function a(e,t,n){var i,s,o="";for(t/=8,i=0;i<t;i+=1)s=e[i>>>2]>>>8*(3+i%4*-1),o+="0123456789abcdef".charAt(s>>>4&15)+"0123456789abcdef".charAt(15&s);return n.outputUpper?o.toUpperCase():o}function u(e,t,n){var i,s,o,r="",a=t/8;for(i=0;i<a;i+=3)for(s=i+1<a?e[i+1>>>2]:0,o=i+2<a?e[i+2>>>2]:0,o=(e[i>>>2]>>>8*(3+i%4*-1)&255)<<16|(s>>>8*(3+(i+1)%4*-1)&255)<<8|o>>>8*(3+(i+2)%4*-1)&255,s=0;4>s;s+=1)r+=8*i+6*s<=t?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>>6*(3-s)&63):n.b64Pad;return r}function c(e,t){var n,i,s="",o=t/8;for(n=0;n<o;n+=1)i=e[n>>>2]>>>8*(3+n%4*-1)&255,s+=String.fromCharCode(i);return s}function h(e,t){var n,i,s=t/8,o=new ArrayBuffer(s);for(i=new Uint8Array(o),n=0;n<s;n+=1)i[n]=e[n>>>2]>>>8*(3+n%4*-1)&255;return o}function l(e,t){var n,i=t/8,s=new Uint8Array(i);for(n=0;n<i;n+=1)s[n]=e[n>>>2]>>>8*(3+n%4*-1)&255;return s}function f(e){var t={outputUpper:!1,b64Pad:"=",shakeLen:-1};if(e=e||{},t.outputUpper=e.outputUpper||!1,!0===e.hasOwnProperty("b64Pad")&&(t.b64Pad=e.b64Pad),"boolean"!=typeof t.outputUpper)throw Error("Invalid outputUpper formatting option");if("string"!=typeof t.b64Pad)throw Error("Invalid b64Pad formatting option");return t}function d(e,t){var n;switch(t){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(e){case"HEX":n=function(e,t,n){var i,s,o,r,a,u=e.length;if(0!=u%2)throw Error("String of HEX type must be in byte increments");for(t=t||[0],a=(n=n||0)>>>3,i=0;i<u;i+=2){if(s=parseInt(e.substr(i,2),16),isNaN(s))throw Error("String of HEX type contains invalid characters");for(o=(r=(i>>>1)+a)>>>2;t.length<=o;)t.push(0);t[o]|=s<<8*(3+r%4*-1)}return{value:t,binLen:4*u+n}};break;case"TEXT":n=function(e,n,i){var s,o,r,a,u,c,h,l,f=0;if(n=n||[0],u=(i=i||0)>>>3,"UTF8"===t)for(l=3,r=0;r<e.length;r+=1)for(o=[],128>(s=e.charCodeAt(r))?o.push(s):2048>s?(o.push(192|s>>>6),o.push(128|63&s)):55296>s||57344<=s?o.push(224|s>>>12,128|s>>>6&63,128|63&s):(r+=1,s=65536+((1023&s)<<10|1023&e.charCodeAt(r)),o.push(240|s>>>18,128|s>>>12&63,128|s>>>6&63,128|63&s)),a=0;a<o.length;a+=1){for(c=(h=f+u)>>>2;n.length<=c;)n.push(0);n[c]|=o[a]<<8*(l+h%4*-1),f+=1}else if("UTF16BE"===t||"UTF16LE"===t)for(l=2,o="UTF16LE"===t||"UTF16LE"!==t&&!1,r=0;r<e.length;r+=1){for(s=e.charCodeAt(r),!0===o&&(s=(a=255&s)<<8|s>>>8),c=(h=f+u)>>>2;n.length<=c;)n.push(0);n[c]|=s<<8*(l+h%4*-1),f+=2}return{value:n,binLen:8*f+i}};break;case"B64":n=function(e,t,n){var i,s,o,r,a,u,c,h=0;if(-1===e.search(/^[a-zA-Z0-9=+\/]+$/))throw Error("Invalid character in base-64 string");if(s=e.indexOf("="),e=e.replace(/\=/g,""),-1!==s&&s<e.length)throw Error("Invalid '=' found in base-64 string");for(t=t||[0],u=(n=n||0)>>>3,s=0;s<e.length;s+=4){for(a=e.substr(s,4),o=r=0;o<a.length;o+=1)r|=(i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(o)))<<18-6*o;for(o=0;o<a.length-1;o+=1){for(i=(c=h+u)>>>2;t.length<=i;)t.push(0);t[i]|=(r>>>16-8*o&255)<<8*(3+c%4*-1),h+=1}}return{value:t,binLen:8*h+n}};break;case"BYTES":n=function(e,t,n){var i,s,o,r,a;for(t=t||[0],o=(n=n||0)>>>3,s=0;s<e.length;s+=1)i=e.charCodeAt(s),r=(a=s+o)>>>2,t.length<=r&&t.push(0),t[r]|=i<<8*(3+a%4*-1);return{value:t,binLen:8*e.length+n}};break;case"ARRAYBUFFER":try{n=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}n=function(e,t,n){return r(new Uint8Array(e),t,n)};break;case"UINT8ARRAY":try{n=new Uint8Array(0)}catch(e){throw Error("UINT8ARRAY not supported by this environment")}n=function(e,t,n){return r(e,t,n)};break;default:throw Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}return n}function p(e,t){return e<<t|e>>>32-t}function m(e,t){var n=(65535&e)+(65535&t);return((e>>>16)+(t>>>16)+(n>>>16)&65535)<<16|65535&n}function v(e,t,n,i,s){var o=(65535&e)+(65535&t)+(65535&n)+(65535&i)+(65535&s);return((e>>>16)+(t>>>16)+(n>>>16)+(i>>>16)+(s>>>16)+(o>>>16)&65535)<<16|65535&o}function g(e){if("SHA-1"!==e)throw Error("No SHA variants supported");return[1732584193,4023233417,2562383102,271733878,3285377520]}function b(e,t){var n,i,s,o,r,a,u,c=[];for(n=t[0],i=t[1],s=t[2],o=t[3],r=t[4],u=0;80>u;u+=1)c[u]=16>u?e[u]:p(c[u-3]^c[u-8]^c[u-14]^c[u-16],1),a=20>u?v(p(n,5),i&s^~i&o,r,1518500249,c[u]):40>u?v(p(n,5),i^s^o,r,1859775393,c[u]):60>u?v(p(n,5),i&s^i&o^s&o,r,2400959708,c[u]):v(p(n,5),i^s^o,r,3395469782,c[u]),r=o,o=s,s=p(i,30),i=n,n=a;return t[0]=m(n,t[0]),t[1]=m(i,t[1]),t[2]=m(s,t[2]),t[3]=m(o,t[3]),t[4]=m(r,t[4]),t}function T(e,t,n,i){var s;for(s=15+(t+65>>>9<<4);e.length<=s;)e.push(0);for(e[t>>>5]|=128<<24-t%32,t+=n,e[s]=4294967295&t,e[s-1]=t/4294967296|0,t=e.length,s=0;s<t;s+=16)i=b(e.slice(s,s+16),i);return i}void 0===(i=function(){return o}.call(t,n,t,e))||(e.exports=i)}()},13:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return a}));function i(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n}function s(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}u((i=i.apply(e,t||[])).next())}))}function o(e,t){var n,i,s,o,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=2&o[0]?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,i=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(s=r.trys,(s=s.length>0&&s[s.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(6===o[0]&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],i=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}Object.create;function r(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,s,o=n.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)r.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(s)throw s.error}}return r}function a(e,t,n){if(n||2===arguments.length)for(var i,s=0,o=t.length;s<o;s++)!i&&s in t||(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}Object.create},15:function(e,t,n){"use strict";n.d(t,"m",(function(){return s})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return u})),n.d(t,"j",(function(){return h})),n.d(t,"a",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"i",(function(){return g})),n.d(t,"l",(function(){return b}));var i=n(39);function s(e){return function(){try{return e.apply(this,arguments)}catch(e){0}}}function o(e){const t=e.replace(/%2F/g,"/").replace(/^.*?\/([^\/]+?)(?:\?.*)?$/,"$1");return decodeURIComponent(t)}function r(e){return/(gif|png|jpg|jpeg|svg|bmp)$/i.test(e)}function a(e,t,n){return Object(i.a)(`${e}_${t}_${n||"GLOBAL"}`)}function u(e){return new Promise((t=>setTimeout(t,e)))}const c=()=>!0;async function h(e,t,{initialDelay:n,log:i,retriedCount:s=0,shouldRetry:o=c}){return t().catch((async r=>{if(i&&i(`[TalkJS] Retries left: ${e}. Error: ${JSON.stringify(r)}.`),0===e)throw r;if(!await o(r))throw r;return u(1e3*n*Math.pow(2,s)).then((()=>h(e-1,t,{retriedCount:s+1,initialDelay:n,log:i})))}))}const l=1900;function f(e){const t=e.slice().sort(((e,t)=>e.length-t.length));let n=0,s=0;for(s=0;s!==t.length&&(n+=t[s].length+"&".length,!(n>l));s++);const o=t.slice(0,s).join("&"),r=t.slice(s).join("&");return{short:o,long:r,key:r?Object(i.a)(r):void 0}}function d(e){return t=JSON.stringify(e),btoa(unescape(encodeURIComponent(t)));var t}function p(){const e={},t=new Promise((function(t,n){e.resolve=t,e.reject=n}));return e.promise=t,e}class m{constructor(e){this.u=e}add(e,t){return new m(this.u.concat([[e,t]]))}split(){return f(this.T())}T(){return this.O||(this.O=this.u.map((([e,t])=>(null==t&&(t=""),"object"==typeof t&&(t=d(t)),e+"="+encodeURIComponent(t))))),this.O}toString(){return this.T().join("&")}}const v={ByV39eoc:1,B1FxElnd:1,aW4c49tW:1,qGfuGtx:1,SbERe5ee:1,ilaVEa15:1,FOlWOSaH:1,dao5gGmT:1,DLUgAhzL:1,fqXFumr6:1,FtiWHMYT:1,"66iWOyWt":1,"1375amYi":1,mWbJgzpt:1,jO7GqAvL:1,SkFIKxo5:1,"2z4ILc3y":1,aDr8oPL1:1,Hku1c4Pt:1};function g(e){return!b(e,"t")&&!v[e]}function b(e,t,n){return n=n||0,e.substr(n,t.length)===t}},16:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return a})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return h})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var i,s,o=n(7);function r(e,t){return t.filter((t=>!0===e.participants[t.id].canRead)).map(u)}function a(e,t){return 1===t.length?[e]:t.filter((t=>t.id!==e.id))}function u(e){return{id:e.externalId,name:e.name,welcomeMessage:e.welcomeMessage,photoUrl:e.photoUrl,role:e.configuration,configuration:e.configuration,custom:e.custom,availabilityText:e.availabilityText,locale:e.locale,email:"<suppressed>",phone:"<suppressed>"}}function c(e,t){const n=o.b(e.participants,(e=>e.canRead)),i=o.h(n,(([e,n])=>{const i=l(n);return[t[e],{access:i}]}));return{custom:e.custom,id:e.externalId,photoUrl:e.photoUrl,subject:e.subject,topicId:e.topicId,welcomeMessages:e.welcomeMessages,participants:i}}function h(e,t,n,i,s){const o=n&&u(n);return{id:e.externalId,type:f(e),conversation:c(t,s),senderId:o&&o.id.toString(),sender:o,isByMe:!!n&&n.id===i,body:e.text,location:e.location,attachment:e.attachment,timestamp:e.createdAt,read:e.senderId===i||!!e.received[i],custom:e.custom,origin:e.origin}}function l({canWrite:e,canRead:t}){return e?"ReadWrite":t?"Read":"None"}function f(e){return e.attachment?"media":e.location?"location":"text"}!function(e){e[e.Inbox=0]="Inbox",e[e.Chatbox=1]="Chatbox",e[e.Popup=2]="Popup"}(i||(i={})),function(e){e[e.Widget=0]="Widget",e[e.Popover=1]="Popover"}(s||(s={}))},20:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i extends Error{constructor(e,t){const n=function(e){if("string"==typeof e)return e;if(Array.isArray(e))return e.join("\n");try{return JSON.stringify(e)}catch(t){return String(e)}}(e);super(n),this.userMessage=null!=t?t:n,Object.setPrototypeOf&&Object.setPrototypeOf(this,new.target.prototype)}}},25:function(e,t,n){"use strict";let i;i=window.initialData?window.initialData.KEYS:{},t.a={MAX_INITIAL_MESSAGES:60,MAX_INITIALLY_VISIBLE_MESSAGES:30,LOAD_MORE_MESSAGES_STEP:30,LOAD_MORE_CHATS_STEP:50,ALL_MESSAGES:600,INITIAL_CHATS_LOADED:50,INITIALLY_VISIBLE_CHATS_IN_HUB:15,GOOGLE_MAPS_API_KEY:i.GOOGLE_MAPS_API_KEY,IFRAMELY_API_KEY:i.IFRAMELY_API_KEY,FIREBASE:i.FIREBASE}},256:function(e,t,n){e.exports=n(367)},27:function(e,t,n){"use strict";function i(e,t){for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(e[n],n)}n.d(t,"a",(function(){return i}))},366:function(e,t,n){e.exports=n.p+"5e83cb28291edefe5f467e9b31453b97.mp3"},367:function(e,t,n){var i,s;(s=function(){"use strict";var e={DAY:864e5,HOUR:36e5,MINUTE:6e4,SECOND:1e3,BASELINE_YEAR:2014,MAX_SCORE:864e6,AMBIGUITIES:{"America/Denver":["America/Mazatlan"],"Europe/London":["Africa/Casablanca"],"America/Chicago":["America/Mexico_City"],"America/Asuncion":["America/Campo_Grande","America/Santiago"],"America/Montevideo":["America/Sao_Paulo","America/Santiago"],"Asia/Beirut":["Asia/Amman","Asia/Jerusalem","Europe/Helsinki","Asia/Damascus","Africa/Cairo","Asia/Gaza","Europe/Minsk"],"Pacific/Auckland":["Pacific/Fiji"],"America/Los_Angeles":["America/Santa_Isabel"],"America/New_York":["America/Havana"],"America/Halifax":["America/Goose_Bay"],"America/Godthab":["America/Miquelon"],"Asia/Dubai":["Asia/Yerevan"],"Asia/Jakarta":["Asia/Krasnoyarsk"],"Asia/Shanghai":["Asia/Irkutsk","Australia/Perth"],"Australia/Sydney":["Australia/Lord_Howe"],"Asia/Tokyo":["Asia/Yakutsk"],"Asia/Dhaka":["Asia/Omsk"],"Asia/Baku":["Asia/Yerevan"],"Australia/Brisbane":["Asia/Vladivostok"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Majuro":["Asia/Kamchatka","Pacific/Fiji"],"Pacific/Tongatapu":["Pacific/Apia"],"Asia/Baghdad":["Europe/Minsk","Europe/Moscow"],"Asia/Karachi":["Asia/Yekaterinburg"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"]}},t=function(e){var t=-e.getTimezoneOffset();return null!==t?t:0},n=function(){var n=t(new Date(e.BASELINE_YEAR,0,2)),i=t(new Date(e.BASELINE_YEAR,5,2)),s=n-i;return s<0?n+",1":s>0?i+",1,s":n+",0"},i=function(e){for(var t=new Date(e,0,1,0,0,1,0).getTime(),n=new Date(e,12,31,23,59,59).getTime(),i=t,s=new Date(i).getTimezoneOffset(),r=null,a=null;i<n-864e5;){var u=new Date(i),c=u.getTimezoneOffset();c!==s&&(c<s&&(r=u),c>s&&(a=u),s=c),i+=864e5}return!(!r||!a)&&{s:o(r).getTime(),e:o(a).getTime()}},o=function t(n,i,s){void 0===i&&(i=e.DAY,s=e.HOUR);for(var o=new Date(n.getTime()-i).getTime(),r=n.getTime()+i,a=new Date(o).getTimezoneOffset(),u=o,c=null;u<r-s;){var h=new Date(u);if(h.getTimezoneOffset()!==a){c=h;break}u+=s}return i===e.DAY?t(c,e.HOUR,e.MINUTE):i===e.HOUR?t(c,e.MINUTE,e.SECOND):c},r=function(t){var n=function(){for(var e=[],t=0;t<s.olson.dst_rules.years.length;t++){var n=i(s.olson.dst_rules.years[t]);e.push(n)}return e}();return function(e){for(var t=0;t<e.length;t++)if(!1!==e[t])return!0;return!1}(n)?function(t,n){for(var i=function(i){for(var s=0,o=0;o<t.length;o++)if(i.rules[o]&&t[o]){if(!(t[o].s>=i.rules[o].s&&t[o].e<=i.rules[o].e)){s="N/A";break}if(s=0,s+=Math.abs(t[o].s-i.rules[o].s),(s+=Math.abs(i.rules[o].e-t[o].e))>e.MAX_SCORE){s="N/A";break}}return function(e,t,n,i){if("N/A"!==n)return n;if("Asia/Beirut"===t){if("Africa/Cairo"===i.name&&13983768e5===e[6].s&&14116788e5===e[6].e)return 0;if("Asia/Jerusalem"===i.name&&13959648e5===e[6].s&&14118588e5===e[6].e)return 0}else if("America/Santiago"===t){if("America/Asuncion"===i.name&&14124816e5===e[6].s&&1397358e6===e[6].e)return 0;if("America/Campo_Grande"===i.name&&14136912e5===e[6].s&&13925196e5===e[6].e)return 0}else if("America/Montevideo"===t){if("America/Sao_Paulo"===i.name&&14136876e5===e[6].s&&1392516e6===e[6].e)return 0}else if("Pacific/Auckland"===t&&"Pacific/Fiji"===i.name&&14142456e5===e[6].s&&13961016e5===e[6].e)return 0;return n}(t,n,s,i)},o={},r=s.olson.dst_rules.zones,a=r.length,u=e.AMBIGUITIES[n],c=0;c<a;c++){var h=r[c],l=i(r[c]);"N/A"!==l&&(o[h.name]=l)}for(var f in o)if(o.hasOwnProperty(f))for(var d=0;d<u.length;d++)if(u[d]===f)return f;return n}(n,t):t};return{determine:function(){var i=function(){var e,t;if("undefined"!=typeof Intl&&void 0!==Intl.DateTimeFormat&&void 0!==(e=Intl.DateTimeFormat())&&void 0!==e.resolvedOptions)return(t=e.resolvedOptions().timeZone)&&(t.indexOf("/")>-1||"UTC"===t)&&0!=t.indexOf("Etc")?t:void 0}();return i||(i=s.olson.timezones[n()],void 0!==e.AMBIGUITIES[i]&&(i=r(i))),{name:function(){return i},stdTimezoneOffset:function(){return-n().split(",")[0]},timezoneOffset:function(){return-t(new Date)}}}}}()).olson=s.olson||{},s.olson.timezones={"-720,0":"Etc/GMT+12","-660,0":"Pacific/Pago_Pago","-660,1,s":"Pacific/Apia","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Asuncion","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Majuro","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},s.olson.dst_rules={years:[2008,2009,2010,2011,2012,2013,2014],zones:[{name:"Africa/Cairo",rules:[{e:12199572e5,s:12090744e5},{e:1250802e6,s:1240524e6},{e:12858804e5,s:12840696e5},!1,!1,!1,{e:14116788e5,s:1406844e6}]},{name:"Africa/Casablanca",rules:[{e:12202236e5,s:12122784e5},{e:12508092e5,s:12438144e5},{e:1281222e6,s:12727584e5},{e:13120668e5,s:13017888e5},{e:13489704e5,s:1345428e6},{e:13828392e5,s:13761e8},{e:14142888e5,s:14069448e5}]},{name:"America/Asuncion",rules:[{e:12050316e5,s:12243888e5},{e:12364812e5,s:12558384e5},{e:12709548e5,s:12860784e5},{e:13024044e5,s:1317528e6},{e:1333854e6,s:13495824e5},{e:1364094e6,s:1381032e6},{e:13955436e5,s:14124816e5}]},{name:"America/Campo_Grande",rules:[{e:12032172e5,s:12243888e5},{e:12346668e5,s:12558384e5},{e:12667212e5,s:1287288e6},{e:12981708e5,s:13187376e5},{e:13302252e5,s:1350792e6},{e:136107e7,s:13822416e5},{e:13925196e5,s:14136912e5}]},{name:"America/Goose_Bay",rules:[{e:122559486e4,s:120503526e4},{e:125704446e4,s:123648486e4},{e:128909886e4,s:126853926e4},{e:13205556e5,s:129998886e4},{e:13520052e5,s:13314456e5},{e:13834548e5,s:13628952e5},{e:14149044e5,s:13943448e5}]},{name:"America/Havana",rules:[{e:12249972e5,s:12056436e5},{e:12564468e5,s:12364884e5},{e:12885012e5,s:12685428e5},{e:13211604e5,s:13005972e5},{e:13520052e5,s:13332564e5},{e:13834548e5,s:13628916e5},{e:14149044e5,s:13943412e5}]},{name:"America/Mazatlan",rules:[{e:1225008e6,s:12074724e5},{e:12564576e5,s:1238922e6},{e:1288512e6,s:12703716e5},{e:13199616e5,s:13018212e5},{e:13514112e5,s:13332708e5},{e:13828608e5,s:13653252e5},{e:14143104e5,s:13967748e5}]},{name:"America/Mexico_City",rules:[{e:12250044e5,s:12074688e5},{e:1256454e6,s:12389184e5},{e:12885084e5,s:1270368e6},{e:1319958e6,s:13018176e5},{e:13514076e5,s:13332672e5},{e:13828572e5,s:13653216e5},{e:14143068e5,s:13967712e5}]},{name:"America/Miquelon",rules:[{e:12255984e5,s:12050388e5},{e:1257048e6,s:12364884e5},{e:12891024e5,s:12685428e5},{e:1320552e6,s:12999924e5},{e:13520016e5,s:1331442e6},{e:13834512e5,s:13628916e5},{e:14149008e5,s:13943412e5}]},{name:"America/Santa_Isabel",rules:[{e:12250116e5,s:1207476e6},{e:12564612e5,s:12389256e5},{e:12885156e5,s:12703752e5},{e:13199652e5,s:13018248e5},{e:13514148e5,s:13332744e5},{e:13828644e5,s:13653288e5},{e:1414314e6,s:13967784e5}]},{name:"America/Santiago",rules:[{e:1206846e6,s:1223784e6},{e:1237086e6,s:12552336e5},{e:127035e7,s:12866832e5},{e:13048236e5,s:13138992e5},{e:13356684e5,s:13465584e5},{e:1367118e6,s:13786128e5},{e:13985676e5,s:14100624e5}]},{name:"America/Sao_Paulo",rules:[{e:12032136e5,s:12243852e5},{e:12346632e5,s:12558348e5},{e:12667176e5,s:12872844e5},{e:12981672e5,s:1318734e6},{e:13302216e5,s:13507884e5},{e:13610664e5,s:1382238e6},{e:1392516e6,s:14136876e5}]},{name:"Asia/Amman",rules:[{e:1225404e6,s:12066552e5},{e:12568536e5,s:12381048e5},{e:12883032e5,s:12695544e5},{e:13197528e5,s:13016088e5},!1,!1,{e:14147064e5,s:13959576e5}]},{name:"Asia/Damascus",rules:[{e:12254868e5,s:120726e7},{e:125685e7,s:12381048e5},{e:12882996e5,s:12701592e5},{e:13197492e5,s:13016088e5},{e:13511988e5,s:13330584e5},{e:13826484e5,s:1364508e6},{e:14147028e5,s:13959576e5}]},{name:"Asia/Dubai",rules:[!1,!1,!1,!1,!1,!1,!1]},{name:"Asia/Gaza",rules:[{e:12199572e5,s:12066552e5},{e:12520152e5,s:12381048e5},{e:1281474e6,s:126964086e4},{e:1312146e6,s:130160886e4},{e:13481784e5,s:13330584e5},{e:13802292e5,s:1364508e6},{e:1414098e6,s:13959576e5}]},{name:"Asia/Irkutsk",rules:[{e:12249576e5,s:12068136e5},{e:12564072e5,s:12382632e5},{e:12884616e5,s:12697128e5},!1,!1,!1,!1]},{name:"Asia/Jerusalem",rules:[{e:12231612e5,s:12066624e5},{e:1254006e6,s:1238112e6},{e:1284246e6,s:12695616e5},{e:131751e7,s:1301616e6},{e:13483548e5,s:13330656e5},{e:13828284e5,s:13645152e5},{e:1414278e6,s:13959648e5}]},{name:"Asia/Kamchatka",rules:[{e:12249432e5,s:12067992e5},{e:12563928e5,s:12382488e5},{e:12884508e5,s:12696984e5},!1,!1,!1,!1]},{name:"Asia/Krasnoyarsk",rules:[{e:12249612e5,s:12068172e5},{e:12564108e5,s:12382668e5},{e:12884652e5,s:12697164e5},!1,!1,!1,!1]},{name:"Asia/Omsk",rules:[{e:12249648e5,s:12068208e5},{e:12564144e5,s:12382704e5},{e:12884688e5,s:126972e7},!1,!1,!1,!1]},{name:"Asia/Vladivostok",rules:[{e:12249504e5,s:12068064e5},{e:12564e8,s:1238256e6},{e:12884544e5,s:12697056e5},!1,!1,!1,!1]},{name:"Asia/Yakutsk",rules:[{e:1224954e6,s:120681e7},{e:12564036e5,s:12382596e5},{e:1288458e6,s:12697092e5},!1,!1,!1,!1]},{name:"Asia/Yekaterinburg",rules:[{e:12249684e5,s:12068244e5},{e:1256418e6,s:1238274e6},{e:12884724e5,s:12697236e5},!1,!1,!1,!1]},{name:"Asia/Yerevan",rules:[{e:1224972e6,s:1206828e6},{e:12564216e5,s:12382776e5},{e:1288476e6,s:12697272e5},{e:13199256e5,s:13011768e5},!1,!1,!1]},{name:"Australia/Lord_Howe",rules:[{e:12074076e5,s:12231342e5},{e:12388572e5,s:12545838e5},{e:12703068e5,s:12860334e5},{e:13017564e5,s:1317483e6},{e:1333206e6,s:13495374e5},{e:13652604e5,s:1380987e6},{e:139671e7,s:14124366e5}]},{name:"Australia/Perth",rules:[{e:12068136e5,s:12249576e5},!1,!1,!1,!1,!1,!1]},{name:"Europe/Helsinki",rules:[{e:12249828e5,s:12068388e5},{e:12564324e5,s:12382884e5},{e:12884868e5,s:1269738e6},{e:13199364e5,s:13011876e5},{e:1351386e6,s:13326372e5},{e:13828356e5,s:13646916e5},{e:14142852e5,s:13961412e5}]},{name:"Europe/Minsk",rules:[{e:12249792e5,s:12068352e5},{e:12564288e5,s:12382848e5},{e:12884832e5,s:12697344e5},!1,!1,!1,!1]},{name:"Europe/Moscow",rules:[{e:12249756e5,s:12068316e5},{e:12564252e5,s:12382812e5},{e:12884796e5,s:12697308e5},!1,!1,!1,!1]},{name:"Pacific/Apia",rules:[!1,!1,!1,{e:13017528e5,s:13168728e5},{e:13332024e5,s:13489272e5},{e:13652568e5,s:13803768e5},{e:13967064e5,s:14118264e5}]},{name:"Pacific/Fiji",rules:[!1,!1,{e:12696984e5,s:12878424e5},{e:13271544e5,s:1319292e6},{e:1358604e6,s:13507416e5},{e:139005e7,s:1382796e6},{e:14215032e5,s:14148504e5}]},{name:"Europe/London",rules:[{e:12249828e5,s:12068388e5},{e:12564324e5,s:12382884e5},{e:12884868e5,s:1269738e6},{e:13199364e5,s:13011876e5},{e:1351386e6,s:13326372e5},{e:13828356e5,s:13646916e5},{e:14142852e5,s:13961412e5}]}]},void 0!==e.exports?e.exports=s:null!==n(368)&&null!=n(369)?void 0===(i=function(){return s}.apply(t,[]))||(e.exports=i):window.jstz=s},368:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},369:function(e,t){(function(t){e.exports=t}).call(this,{})},37:function(e,t,n){"use strict";var i=n(60);n.d(t,"a",(function(){return i.a})),n.d(t,"b",(function(){return i.b})),n.d(t,"c",(function(){return i.c}))},370:function(e,t,n){e.exports=n.p+"a456dac518f91d4f4cd3c6de4367c25d.css"},371:function(e,t,n){"use strict";n.r(t),t.default={ar:{DESKTOP_NOTIFICATIONS_ERROR:"لا يمكن تمكين إشعارات سطح المكتب نظرًا لأن المتصفح يعمل على حظرها بشكل نشط. جرّب البحث في الإعدادات أو استخدام متصفح آخر.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"إعلام $APPNAME التجريبي",DESKTOP_NOTIFICATIONS_DEMO_BODY:"إذا أبقيت علامة تبويب المتصفح مفتوحة ، فسترى هذا ينبثق عندما يتحدث شخص معك."},bg:{DESKTOP_NOTIFICATIONS_ERROR:"Не можете да активирате известията на работния плот, защото браузърът ви активно ги блокира. Опитайте да погледнете в настройките или да използвате друг браузър.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME демо известие",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Ако държите раздела на браузъра си отворен, ще видите този изскачащ прозорец, когато някой говори с вас."},bs:{DESKTOP_NOTIFICATIONS_ERROR:"Desktop notifikacije nisu omogućene jer ih vaš preglednik aktivno blokira. Pokušajte pogledati postavke ili koristiti neki drugi preglednik.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME demo notifikacija",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Ako karticu preglednika ostavite otvorenu, pojavit će se ovaj pop-up kada netko razgovara s vama."},ca:{DESKTOP_NOTIFICATIONS_ERROR:"No es poden habilitar les notificacions d'escriptori perquè el teu navegador les bloqueja activament. Prova de buscar a la configuració o utilitza un navegador diferent.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"Notificació de demostració de $APPNAME",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Si mantens la pestanya del navegador oberta, veuràs aquesta notificació quan algú et parli."},cs:{DESKTOP_NOTIFICATIONS_ERROR:"Nelze povolit upozornění na ploše, protože váš prohlížeč je aktivně blokuje. Zkuste se podívat na nastavení nebo zkuste použít jiný prohlížeč.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME demo notifikace",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Pokud necháte kartu prohlížeče otevřenou, uvidíte tento popup jakmile s vámi bude někdo mluvit."},da:{DESKTOP_NOTIFICATIONS_ERROR:"Kan ikke aktivere skrivebordsmeddelelser, fordi din browser aktivt blokerer dem. Prøv at kigge i indstillingerne eller benyt en anden browser.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME demomeddelelse",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Hvis du holder dit browser-faneblad åben, vil du se det her komme op, når nogen taler til dig."},de:{DESKTOP_NOTIFICATIONS_ERROR:"Desktop-Benachrichtigungen können nicht aktiviert werden, da Ihr Browser sie aktiv blockiert. Versuchen Sie, in den Einstellungen nachzuschlagen oder einen anderen Browser zu verwenden.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME Demo-Benachrichtigung",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Wenn Sie Ihre Browser-Registerkarte geöffnet lassen, wird dies angezeigt, wenn jemand mit Ihnen spricht."},el:{DESKTOP_NOTIFICATIONS_ERROR:"Δεν είναι δυνατή η ενεργοποίηση των ειδοποιήσεων της επιφάνειας εργασίας,επειδή το πρόγραμμα περιήγησης τις μπλοκάρει. Δοκιμάστε να τσεκάρετε τις ρυθμίσεις η χρησιμοποιήστε άλλο πρόγραμμα περιήγησης.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME Δοκιμαστική επίδειξη",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Αν διατηρήσετε ανοιχτή τη σελίδα του προγράμματος περιήγησης, θα δείτε αυτό το pop up (παράθυρο) όταν κάποιος σας μιλάει."},en:{DESKTOP_NOTIFICATIONS_ERROR:"Can't enable desktop notifications because your browser actively blocks them. Try looking in the settings or using a different browser.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME demo notification",DESKTOP_NOTIFICATIONS_DEMO_BODY:"If you keep your browser tab open, you'll see this pop up when someone talks to you."},es:{DESKTOP_NOTIFICATIONS_ERROR:"No se logró habilitar las notificaciones de escritorio, comprueba que tu navegador no las esté bloqueando o intenta con otro navegador.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME notificación de prueba",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Si dejas esta pestaña abierta, verás este pop up cuando alguien te hable."},et:{DESKTOP_NOTIFICATIONS_ERROR:"Töölaua teavitusi ei saa lubada, kuna Teie brauser blokeerib need aktiivselt. Proovige muuta seadeid või kasutada mõnda muud brauserit.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME demo teavitus",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Kui hoiate oma brauseri vahekaardi lahti ja näete seda hüpikakent, siis keegi soovib Teiega rääkida."},fa:{DESKTOP_NOTIFICATIONS_ERROR:"خطا در فعال سازی اعلان های دسکتا‌پ، مرورگر شما آنها را مسدود می کند سعی کنید تنظیمات مرورگر را تغییر دهدید یا از یک مرورگر دیگر استفاده کنید.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"نوتیفیکیشن دمو $APPNAME",DESKTOP_NOTIFICATIONS_DEMO_BODY:"اگر صفحه ی مرورگر را باز نگهدارید این را موقعه ای که کسی با شما صحبت کند خواهید دید"},fi:{DESKTOP_NOTIFICATIONS_ERROR:"Työpöydän ilmoituksia ei voitu kytkeä päälle, koska selaimesi estää sen. Koeta tutkia sen asetuksia tai vaihda selainta.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME demo ilmoitus",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Jos pidät tämän sivun auki, näet vastaavan ilmoituksen kun joku puhuu sinulle."},fr:{DESKTOP_NOTIFICATIONS_ERROR:"Impossible d'activer les notifications sur votre ordinateur car votre navigateur les bloque. Essayez de changer ses paramètres ou de changer de navigateur.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"Notification de démonstration $APPNAME",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Si vous maintenez l'onglet ouvert dans votre navigateur vous verrez apparaître une alerte lorsque quelqu'un vous parlera."},he:{DESKTOP_NOTIFICATIONS_ERROR:"לא ניתן להפעיל התראות בשולחן העבודה מכיוון שהדפדפן שלך חוסם אותן באופן פעיל. נסה להסתכל בהגדרות או להשתמש בדפדפן אחר.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME הודעה על הדגמה",DESKTOP_NOTIFICATIONS_DEMO_BODY:"אם אתה שומר על כרטיסיית הדפדפן שלך פתוחה, תראה את זה צץ כשמישהו ידבר איתך."},hi:{DESKTOP_NOTIFICATIONS_ERROR:"डेस्कटॉप सूचनाएं सक्षम नहीं कर सकता क्योंकि आपका ब्राउज़र सक्रिय रूप से उन्हें ब्लॉक करता है। सेटिंग्स में देखने या एक अलग ब्राउज़र का उपयोग करने का प्रयास करें।",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME डेमो अधिसूचना",DESKTOP_NOTIFICATIONS_DEMO_BODY:"यदि आप अपना ब्राउज़र टैब खुला रखते हैं, तो यह पॉप अप आपको तब दिखाई देगा जब कोई आपसे बात करेगा।"},hr:{DESKTOP_NOTIFICATIONS_ERROR:"Desktop notifikacije nisu omogućene jer ih vaš preglednik aktivno blokira. Pokušajte pogledati postavke ili koristiti neki drugi preglednik.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME demo notifikacija",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Ako karticu preglednika ostavite otvorenu, pojavit će se ovaj pop-up kada netko razgovara s vama."},hu:{DESKTOP_NOTIFICATIONS_ERROR:"Azért nem tudja bekapcsolni az asztali értesítések funkciót, mert böngészője aktívan blokkolja azt. Tekintse meg a beállításokat vagy használjon másik böngészőt.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME demo értesítés",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Ha nyitva hagyja böngészőjét, felugró ablak fog megjelenni, ha valaki beszélni szeretne Önnel."},id:{DESKTOP_NOTIFICATIONS_ERROR:"Tidak dapat mengaktifkan pemberitahuan desktop karena browser Anda secara aktif memblokir mereka. Coba cari di pengaturan atau menggunakan browser yang berbeda.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"pemberitahuan demo $APPNAME",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Jika Anda membiarkan tab browser tetap terbuka, Anda akan melihat ini muncul ketika seseorang berbicara kepada Anda."},it:{DESKTOP_NOTIFICATIONS_ERROR:"Impossibile abilitare le notifiche desktop perché il browser le blocca attivamente. Prova a cercare le impostazioni o utilizzare un browser diverso.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME demo notification",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Se si mantiene aperta la scheda del browser, questo verrà visualizzato quando qualcuno ti parla."},ja:{DESKTOP_NOTIFICATIONS_ERROR:"デスクトップの通知はブロックされているため、デスクトップの通知を有効にできません。設定を確認するか、別のブラウザを使用してください。",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME デモ通知",DESKTOP_NOTIFICATIONS_DEMO_BODY:"ブラウザのタブを開いたままにしておくと、誰かがあなたに話しかけたときにこのポップアップが表示されます。"},ka:{DESKTOP_NOTIFICATIONS_ERROR:"შეუძლებელია დესკტოპის შეტკობინებების ჩართვა. ეს ბრაუზერი ბლოკავს მათ. სცადე ცვლილება ოპციებიდან ან გამოიყენე სხვა ბრაუზერი.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME შეტყობინებების დემო ვერსია",DESKTOP_NOTIFICATIONS_DEMO_BODY:"თუ დატოვებ ბრაუზერის ფანჯარას გახსნილს, როცა ვიღაც მოგწერს საუბარი ამოვარდება დესკტოპზე."},ko:{DESKTOP_NOTIFICATIONS_ERROR:"데스크톱 알림을 표시할 수 없습니다. 브라우저 설정을 확인하거나 다른 브라우저를 사용해주세요.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME 데모 알림",DESKTOP_NOTIFICATIONS_DEMO_BODY:"브라우저 탭을 열어 둔 상태에서 누군가 대화 할 때 이 팝업이 표시됩니다."},nb:{DESKTOP_NOTIFICATIONS_ERROR:"Kan ikke aktivere skrivebords varsler fordi nettleseren din aktivt blokkerer dem. Prøv å se i innstillingene eller bruke en annen nettleser.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME demo varslinger",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Hvis du holder nettleservinduet åpent, vil du se dette varsel når noen snakker til deg."},nl:{DESKTOP_NOTIFICATIONS_ERROR:"Desktop notificaties kunnen niet geactiveerd worden omdat de browser het blokkeert. Check de instellingen van je browser of probeer een andere browser.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME demo notificatie",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Als je je browser open houdt, zie je deze popup als iemand tegen je praat."},pl:{DESKTOP_NOTIFICATIONS_ERROR:"Nie można aktywować powiadomień, ponieważ twoja przeglądarka je blokuje. Proszę zmienić ustawienie lub spróbować innej przeglądarki.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME przykładowe powiadomienie",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Jeśli zostawisz tę kartę otwartą, zobaczysz takie powiadomienie, gdy ktoś napisze do Ciebie."},pt:{DESKTOP_NOTIFICATIONS_ERROR:"Não é possível ativar as notificações da área de trabalho porque seu navegador as bloqueia. Tente procurar nas configurações ou usar um navegador diferente.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME notificação de demonstração",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Se você mantiver a guia do navegador aberta, verá essa mensagem quando alguém falar com você."},ro:{DESKTOP_NOTIFICATIONS_ERROR:"Nu se pot activa notificările de pe desktop deoarece browserul dvs. le blochează în mod activ. Încercați să căutați în setări sau utilizând un alt browser.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"Notificare de debit $APPNAME",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Dacă țineți fișa browserului deschis, veți vedea acest pop-up atunci când cineva vorbește cu dvs."},ru:{DESKTOP_NOTIFICATIONS_ERROR:"Невозможно включить оповещения, потому что ваш браузер активно блокирует их. Проверьте ваши настройки или попробуйте другой браузер.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME демо-оповещение",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Если вкладка вашего браузера открыта, вы увидите всплывающее окошко оповещения когда кто-то отправит вам сообщение."},sq:{DESKTOP_NOTIFICATIONS_ERROR:"Nuk mund të aktivizohen njoftimet në desktop sepse shfletuesi juaj i bllokon ato në mënyrë aktive. Provoni të shikoni cilësimet ose përdorni një shfletues të ndryshëm.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME njoftime në desktop",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Lënia e skedës së shfletuesit tuaj të hapur do të pop-up kur dikush flet me ju."},sr:{DESKTOP_NOTIFICATIONS_ERROR:"Desktop notifikacije nisu omogućene jer ih vaš pregledač aktivno blokira. Pokušajte pogledati postavke ili koristiti neki drugi pregledač.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME demo notifikacija",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Ako karticu pregledača ostavite otvorenu, pojaviće se ovaj pop-up kada neko razgovara s vama."},sv:{DESKTOP_NOTIFICATIONS_ERROR:"Kan inte aktivera notiser eftersom din webbläsare aktivt blockerar dem. Se över inställningarna eller använd en annan webbläsare.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME demonotis",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Om du har fliken i webbläsaren öppen så kommer den här notisen visas när någon pratar med dig."},tr:{DESKTOP_NOTIFICATIONS_ERROR:"Tarayıcınız aktif olarak engellediğinden masaüstü bildirimlerini etkinleştiremiyoruz. Ayarları kontrol etmeyi veya farklı bir tarayıcı kullanmayı deneyebilirsiniz.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME test bildirimi",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Eğer tarayıcınızın penceresini açık tutarsanız biri mesaj yazdığında bu bildirimi göreceksiniz."},uk:{DESKTOP_NOTIFICATIONS_ERROR:"Неможливо ввімкнути сповіщення на робочому столі, оскільки ваш веб-переглядач активно їх блокує. Спробуйте переглянути налаштування або використовувати інший браузер.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"Демо-повідомлення про $APPNAME",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Якщо ви відкриєте вкладку веб-переглядача відкритою, ви побачите це спливаюче вікно, коли хтось спілкується з вами."},vi:{DESKTOP_NOTIFICATIONS_ERROR:"Không thể bật thông báo trên màn hình vì trình duyệt của bạn đang tắt chức năng này. Hãy thử tìm trong cài đặt trình duyệt hoặc sử dụng một trình duyệt khác.",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME thông báo thử nghiệm",DESKTOP_NOTIFICATIONS_DEMO_BODY:"Nếu bạn giữ tab trình duyệt của bạn mở, bạn sẽ thấy cửa sổ bật lên khi ai đó nói chuyện với bạn."},zh:{DESKTOP_NOTIFICATIONS_ERROR:"因浏览器设置为阻止，所以无法激活桌面提醒 。请去设置里查看或者尝试其他的浏览器。",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME 演示提醒",DESKTOP_NOTIFICATIONS_DEMO_BODY:"只要保持浏览器开着，如果有人和你对话，将会自动弹出对话窗口。"},"zh-tw":{DESKTOP_NOTIFICATIONS_ERROR:"無法啟用桌面通知，因為您的瀏覽器主動阻止它們。 嘗試查看設置或使用其他瀏覽器。",DESKTOP_NOTIFICATIONS_DEMO_TITLE:"$APPNAME 演示通知",DESKTOP_NOTIFICATIONS_DEMO_BODY:"如果您持續打開瀏覽器標籤頁，當有人與您通話時，您會看到此彈出窗口。"}}},388:function(e,t,n){"use strict";n.r(t);var i,s=n(71);n.p=s.b+"//"+s.c+n.p,function(e){e[e.NOTIFICATIONS_PERMISSION_DENIED=0]="NOTIFICATIONS_PERMISSION_DENIED",e[e.NOTIFICATIONS_NOT_SUPPORTED=1]="NOTIFICATIONS_NOT_SUPPORTED",e[e.ARGUMENT_INVALID=2]="ARGUMENT_INVALID"}(i||(i={}));class o extends Error{constructor(e,t){super(`[TalkJS] ${t}`),this.code=e,Object.setPrototypeOf&&Object.setPrototypeOf(this,new.target.prototype)}}function r(e,t,n,s=[]){const r=p(e);if(-1===t.indexOf(r))throw new o(i.ARGUMENT_INVALID,n);for(let t of s)if(!t(e))throw new o(i.ARGUMENT_INVALID,n);return e}function a(e,t,n){if(-1===t.indexOf(e))throw new o(i.ARGUMENT_INVALID,n)}function u(e,t,n){for(let i in e)r(e[i],t,n(i,e[i]))}function c(e,t,n,i,s,o=[]){void 0!==n&&(e[t]=r(n,i,s,o))}function h(e){return""!==e}function l(e){return!e||/^[a-z]{1,3}(-.+)?$/.test(e)}function f(e){return!(["ios","android"].indexOf(e)<0)}function d(e){return!(["fcm","apns"].indexOf(e)<0)}function p(e){if(null===e)return"null";const t=typeof e;return"object"!==t?t:e instanceof Array?e.length?p(e[0])+"[]":"[]":t}o.Code=i;class m{constructor(e,t){this.user=e,t=r(t,["undefined","object"],'Conversation.setParticipants: optional field "settings" is given but not an object.');let{access:n,notify:i}=t||{access:void 0,notify:void 0};n=r(n,["undefined","string"],'Conversation.setParticipants: optional field "settings.access" is given but not one of "ReadWrite" or "Read".',[e=>void 0===e||("Read"===e||"ReadWrite"===e)]),i=r(i,["undefined","boolean","string"],'Conversation.setParticipants: optional field "settings.notify" is given but not a boolean or "MentionsOnly".',[e=>void 0===e||"boolean"==typeof e||"MentionsOnly"===e]),this.participationSettings={access:n,notify:i},this.participationSetting=this.participationSettings}}var v=n(39);function g(e){return[e=(e=r(e,["string","number"],'User: required field "id" is not given or not a string or a number.',[h])).toString(),Object(v.a)(e)+"_n"]}var b=n(15);const T=Object(b.l)(s.a,"app.talkjs.com"),O=[];function k(e={}){const t={stack:(new Error).stack||"no stack trace available",called:new Date,args:e};return O.push(t),O.length>100&&O.shift(),()=>{t.settled=new Date}}var w=new class{constructor(e){this.k=Date.now(),this.I=T,this._={customer:{application:"",correlationId:"",sessionId:"",token:"",userId:"",version:"TBD"},entry:"direct",environment:{age:Date.now()-this.k,dependencies:{},originalUrl:window.location.href,referrer:document.referrer,userAgent:window.navigator.userAgent},metadata:[],nav:[],network:[],url:window.location.href,stack:"",timestamp:(new Date).toISOString(),version:"TBD",throttled:0},this.S=`https://capture.trackjs.com/capture?token=${e}`,this._.customer.token=e}setData({appId:e,meId:t,sessionId:n}){this._.customer.userId=e,this._.customer.sessionId=`${e}/${t}`,this._.customer.correlationId=n}async log(e){try{if(!this.I)return Promise.resolve();const t=Object.assign(Object.assign({},this._),{message:e,console:y(O)});await E({method:"POST",url:this.S,data:JSON.stringify(t),options:{contentType:"text/plain"}})}catch(e){console.error("[TalkJS] Failed when sending an error report. Error: ",e)}}}("970cd0be0fb74630b75c8451051299dc");function y(e){var t,n;if(!e||0===e.length)return[];try{const i=[],s=[];e.forEach(((e,t)=>{var n;if(!e)return;const o=function(e){var t;try{const n=null===(t=null==e?void 0:e.stack)||void 0===t?void 0:t.split(".prototype."),i=null==n?void 0:n[2];return i?i.substring(0,i.indexOf("@")):"unknown method"}catch(e){return"unknown method"}}(e),r=`#${t} called ${o} with args: ${function(e){const t=()=>{const e=new WeakSet;return(t,n)=>{if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}};try{return JSON.stringify(e,t())}catch(e){return"failed to stringify arguments"}}(e.args)}`;s.push({id:t,message:r,timestamp:null!==(n=e.called)&&void 0!==n?n:new Date});const a=`#${t} full stack: ${e.stack}`;if(i.push({id:t,message:a}),e.settled&&e.called){const n=`#${t} settled after ${e.settled.getTime()-e.called.getTime()}ms (${o})`;s.push({id:t,message:n,timestamp:e.settled})}})),s.sort(((e,t)=>{const n=t.timestamp.getTime()-e.timestamp.getTime();return 0!==n?n:t.id-e.id}));const o=s.map((e=>{const t=e.timestamp.toISOString();return{message:e.message,severity:"info",timestamp:t}})),r=null!==(n=null===(t=s[s.length-1])||void 0===t?void 0:t.timestamp)&&void 0!==n?n:new Date;return i.forEach((e=>{o.push({message:e.message,severity:"debug",timestamp:r.toISOString()})})),o}catch(e){return[{message:"Unhandled exception in errorTracker getConsoleMessages: "+e,severity:"error",timestamp:(new Date).toISOString()}]}}function I(){const e=window.crypto,t=e?()=>e.getRandomValues(new Uint8Array(1))[0]:()=>Math.floor(255*Math.random());return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^t()&15>>e/4).toString(16)))}function _(e,t){const n=i=>{"string"==typeof i.data&&i.data===e&&(t(),window.removeEventListener("message",n))};window.addEventListener("message",n,!1)}function S(e){const t=document.createElement("a");return t.href=e,t.href||e}function E({method:e,url:t,data:n,options:i,attempts:s,shouldRetry:o,authProvider:r}){var a;(!s||s<=0)&&(s=1);const u={"Content-Type":null!==(a=null==i?void 0:i.contentType)&&void 0!==a?a:"application/json"};return Object(b.j)(s,(async()=>{if(r){const e=await r.getToken();u.Authorization=`Bearer ${e}`}return fetch(t,{method:e,headers:u,body:n}).then((e=>{if(e.ok)return e;throw e}))}),{initialDelay:.2,log:void 0,shouldRetry:async n=>r&&401===n.status?(w.log(`401 error from ${e} ${t}, ${await r.getToken()}`),r.refreshToken(),!0):o?o(n):!("status"in n&&n.status>=400&&n.status<500)}).catch((n=>{if(!t.startsWith("https://capture.trackjs.com")){const i=`Network Error for ${e} ${t}`;if(n instanceof Response){n.clone().text().then((e=>{w.log(`${i} ${n.status} ${e}`)}))}else w.log(`${i} ${n}`);console.error("[TalkJS]",i)}throw n}))}function A(e){const t=N(e);document.cookie=`${e}=${t};expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/`}function N(e){let t;try{t=document.cookie}catch(e){return}const n=t.split("; ").map((e=>e.split("="))).map((([e,t])=>({name:e,value:t})));for(let t of n)if(t.name===e)return t.value}function P(e,t){for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}class D{constructor(e,t){this.A=!1,this.N=0;const n=this;this.callback=function(){if(n.N++,n.N>1)throw new Error(`[TalkJS] Cannot call ${e} more than once`);if(n.A)throw new Error(`[TalkJS] Cannot call ${e} asynchronously`);return t.apply(null,arguments)}}expire(){this.A=!0}}class C{constructor(e){this.id=e,this.isLeader=!1,this.P=new Promise((e=>{this.D=e})),"locks"in navigator?navigator.locks.request(this.id,(()=>(this.isLeader=!0,this.P))):this.isLeader=!0}relinquish(){this.D(),this.isLeader=!1}}class M{constructor(e={}){if("string"==typeof(t=e)||t instanceof String||"number"==typeof t||t instanceof Number)this.__sync=!1,[this.id,this.internalId]=g(e);else{this.__sync=!0;let{id:t,name:n,email:i,phone:s,photoUrl:o,welcomeMessage:a,role:f,configuration:d,custom:p,availabilityText:m,locale:v}=e;[this.id,this.internalId]=g(t),c(this,"email",i,["null","undefined","string","string[]"],`User ${t}: optional field "email" is not a string or array of strings. Pass \`null\` if you're sure the user should never get emails`,[h]),c(this,"phone",s,["null","undefined","string","string[]"],`User ${t}: optional field "phone" is given but not a string or array of strings.`,[h]);const b=[].concat(void 0===this.phone||null===this.phone?[]:this.phone);for(let e of b)if(!/^\+[1-9]\d{1,14}$/.test(e))throw new Error(`User ${t}: optional field "phone" does not conform E.164 standard. Numbers should start with a plus, followed by a country code and then the phone number. Numbers must not have any other special characters like dashes or spaces. For example, a UK phone number 0123456789 would be formatted as "+44123456789" (${e}).`);this.name=r(n,["string"],`User ${t}: required field "name" is not given or not a string or is an empty string.`,[h]),c(this,"welcomeMessage",a,["null","undefined","string"],`User ${t}: optional field "welcomeMessage" is given but not a string or is an empty string.`,[h]),c(this,"role",f,["null","undefined","string"],`User ${t}: optional field "role" is given but not a string or is an empty string.`,[h]),c(this,"configuration",d,["null","undefined","string"],`User ${t}: optional field "configuration" is given but not a string or is an empty string.`,[h]),c(this,"custom",p,["null","undefined","object"],`User ${t}: optional field "custom" is given but not an object.`),o=r(o,["null","undefined","string"],`User ${t}: optional field "photoUrl" is given but not a string or is an empty string.`,[h]),this.photoUrl=o?S(o):o,c(this,"availabilityText",m,["null","undefined","string"],`User ${t}: optional field "availabilityText" is given but not a string or is an empty string.`,[h]),c(this,"locale",v,["null","undefined","string"],`User ${t}: optional field "locale" is given but not a string or is an empty string or does not conform the BCP 47 format.`,[h,l]),this.custom&&u(this.custom,["string","null"],(e=>`User ${t}: optional field "custom.${e}" is given but not a string.`)),this.configuration||this.role||console.warn(`[TalkJS] No role is set for user ${t}. TalkJS will work, but with some features disabled (such as email notifications).`),this.configuration&&this.role&&console.warn(`[TalkJS] A configuration and role was set for the user ${t}, the assigned role will take presedence over a configuration.`),this.role&&(this.configuration=this.role)}var t}}function j(e){return!e||"string"==typeof e||"string"==typeof e.id}class R{constructor({conversationId:e,participants:t,topicId:n,subject:i,photoUrl:s,welcomeMessages:o,custom:a}){this.participants=[],this.id=r(e,["string"],"Conversation: field conversationId cannot be empty.",[h]);for(let e of t)this.participants.map((e=>e.user.id)).indexOf(e.user.id)<0&&this.participants.push(e);c(this,"subject",i,["null","undefined","string"],'Conversation: optional field "subject" is given but not a string.'),s=r(s,["null","undefined","string"],'Conversation: optional field "photoUrl" is given but not a string or is an empty string.',[h]),this.photoUrl=s?S(s):s,c(this,"welcomeMessages",o,["null","undefined","string[]"],'Conversation: optional field "welcomeMessages" is given but not an array of strings.'),c(this,"custom",a,["null","undefined","object"],'Conversation: optional field "custom" is given but not an object.'),this.custom&&u(this.custom,["string"],(e=>`Field "custom.${e}" must be a string.`)),void 0!==(n=null!=n?n.toString():void 0)&&(this.topicId=r(n,["string"],'Conversation: optional field "topicId" is given but not a string or is an empty string.',[h])),this.internalId=x(this.id)}}class F{constructor(e,t){this.C=t,this.participants=[],this.id=r(e,["string"],"Conversation: field conversationId cannot be empty.",[h]),this.internalId=x(this.id)}setParticipant(e,t){if(this.C.M(),!(e instanceof M))throw new Error("[TalkJS] The first argument of ConversationBuilder#setParticipant should be of type Talk.User. For example:\n            \nvar user = new Talk.User(data);\nconversation.setParticipant(user);\n            \nFor more information check our documentation https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/ConversationBuilder.html#setparticipant\n            ");this.participants=this.participants.filter((t=>t.user.id!==e.id)),this.participants.push(new m(e,t))}setAttributes(e){this.C.M(),c(this,"subject",e.subject,["null","undefined","string"],'Conversation.setAttributes: optional field "subject" is given but not a string.'),c(this,"custom",e.custom,["null","undefined","object"],'Conversation.setAttributes: optional field "custom" is given but not an object.');const t=r(e.photoUrl,["null","undefined","string"],'Conversation.setAttributes: optional field "photoUrl" is given but not a string or is an empty string.',[h]);this.photoUrl=t?S(t):t,c(this,"welcomeMessages",e.welcomeMessages,["null","undefined","string[]"],'Conversation.setAttributes:Conversation: optional field "welcomeMessages" is given but not an array of strings'),this.custom&&u(this.custom,["null","string"],(e=>`Conversation.setAttributes: Field "custom.${e}" must be a string.`))}sendMessage(e,{custom:t}={}){this.C.M(),e=r(e,["string"],"sendMessage() accepts a single String value representing the text of the message"),t&&u(t,["string"],(e=>`Field "custom.${e}" must be a string.`));const n=this.internalId;return this.C.R.then((i=>i.sendMessage({text:e,custom:t},n)))}leave(){this.C.M();const e=this.internalId;return this.C.R.then((t=>t.leaveConversation(e)))}markAsUnread(){this.C.M();const e=this.internalId;return this.C.R.then((t=>t.markConversationAsUnread(e)))}}function $(e,t,n){return"string"==typeof e&&(e=new M(e)),"string"==typeof t&&(t=new M(t)),function(e,t){const n=e.map((e=>e.id));n.sort();let i={p:n};return void 0!==t&&(i.t=t),JSON.stringify(i)}([e,t],n)}function x(e){return Object(v.a)(e)}var K=n(16),U=n(53);const B="talkjs:desktop_notify",J=function(){try{return Audio&&new Audio(n(366))}catch(e){return null}}();function L(){return window.Notification&&"granted"===Notification.permission}let H=[];function Y({title:e,body:t,conversationId:n}={},i){if(t){if(J)try{J.play()}catch(e){}var s=new Notification(e||"",{body:t,icon:X()});s.onclick=()=>{window.focus(),i()},H.push(s)}}window.addEventListener("focus",(function(){H.forEach(Object(b.m)((e=>e.close()))),H=[]}));let z,W=!1,G=0;async function q(e,{locale:t,alertOnFailure:n,appName:i,emitBrowserPermissionNeeded:s,emitBrowserPermissionDenied:r}){if(U.a.set(B,e),e)try{switch(await async function(e){if(L())return"granted";if(!window.Notification)throw new o(o.Code.NOTIFICATIONS_NOT_SUPPORTED,"The browser doesn't support desktop notifications.");if("cancel"===await e())return"cancelled";return await new Promise((e=>Notification.requestPermission(e))),L()?"granted":"denied"}(s)){case"cancelled":return U.a.set(B,!1),!1;case"granted":return i&&function(e,t){Y({title:t.t("DESKTOP_NOTIFICATIONS_DEMO_TITLE",{APPNAME:e}),body:t.t("DESKTOP_NOTIFICATIONS_DEMO_BODY")},(()=>{}))}(i,t),!0;case"denied":throw U.a.set(B,!1),r(),new o(o.Code.NOTIFICATIONS_PERMISSION_DENIED,"The user or the browser denied permission to send notifications.")}}catch(e){throw n&&alert(t.t("DESKTOP_NOTIFICATIONS_ERROR")),e}return!0}function V(){return L()&&Boolean(U.a.get(B))}function X(){if(z)return z;let e=document.getElementsByTagName("head")[0].getElementsByTagName("link"),t=[];for(let n=e.length-1;n>=0;n--)/(^|\s)icon(\s|$)/i.test(e[n].getAttribute("rel")||"")&&t.push(e[n]);const n=t.reduce(((e,t)=>Q(e)>Q(t)?e:t),void 0);return z=n&&n.getAttribute("href")||void 0,z}function Q(e){return parseInt(e&&(e.getAttribute("sizes")||"").split("x")[0]||"0")}class Z{constructor(e,t={}){this.F=t,this.$={};for(let t in e)e.hasOwnProperty(t)&&(this.$[t]=[])}emit(e,t){for(let n of this.$[e])try{n(t)}catch(t){console.error(`[TalkJS] '${String(e)}' handler threw an error:`,t)}}async emitAsync(e,t){try{const n=this.$[e].map((e=>e(t)));await Promise.all(n)}catch(t){console.error(`[TalkJS] '${String(e)}' handler threw an error:`,t)}}supports(e){return e in this.$}on(e,t){var n,i;if(!this.supports(e))throw new Error(`Unknown event type '${String(e)}'`);null===(i=(n=this.F)[e])||void 0===i||i.call(n),this.$[e].push(t)}off(e,t){if(!(e in this.$))throw new Error(`Unknown event type '${String(e)}'`);const n=this.$[e].indexOf(t);-1!==n&&this.$[e].splice(n,1)}removeAllListeners(){for(let e in this.$)this.$[e]=[]}handles(e){return this.$[e].length>0}subscribe(e,t){return this.on(e,t),new ee((()=>this.off(e,t)))}}class ee{constructor(e){this.K=e}unsubscribe(){this.K()}}var te=n(25);class ne{constructor(e,t,n,i,s){this.R=e,this.U=t,this.B=n,this.externalMeId=i,this.J=s,this.L={change:()=>this.H()},this.Y=new Z({change(e){}},this.L),this.W={},this.G=void 0,this.q=!1,this.V=({id:e,data:t})=>{delete this.W[e]},this.X=(e,{emitNewMessageEvent:t})=>{const n=e||[];let i=[];for(let e of n){const n=this.W[e.id];!t||n&&n.lastMessageTs===e.lastMessageTs||i.push(e),this.W[e.id]=e}const s=Object.keys(this.W).map((e=>this.W[e])).filter((e=>e.canIRead&&!1===e.lastMessageRead)),o=this.Z(s);Promise.all(o).then((e=>{Promise.all(this.Z(i)).then((t=>{this.ee(e);const n=t.filter((e=>!e.side.lastMessageRead));for(let e of n)this.te(e);this.ne(t)}))}))},this.R.then((e=>{this.ie=e})).catch((()=>{}))}H(){this.se||(this.se=this.R.then((()=>{this.oe({amount:te.a.INITIAL_CHATS_LOADED+1})})).catch((()=>{})))}re(){return this.ie.getOrJoinChannel(`seq/sides/${this.ie.me.internalId}`)}ae(e){this.H(),this.se.then((()=>this.oe(e)))}oe({amount:e,lastChatTs:t}){const n=this.re();n.on("recordUpdated",(e=>this.X(e.data,{emitNewMessageEvent:!0}))),n.on("recordDeleted",(e=>this.V(e))),n.push("get_all",{limit:e,oldestRecordTs:t}).receive("ok",(e=>this.X(e.data,{emitNewMessageEvent:!1})))}Z(e){return e.filter((e=>null!==e.lastMessageSenderId)).map((e=>this.ie.getNym(e.lastMessageSenderId).then((t=>({side:e,sender:t})))))}ue(e,t){if(e.length!==t.length)return!0;for(let n of e){const e=t.filter((e=>e.lastMessage.conversation.id===n.lastMessage.conversation.id))[0];if(!e)return!0;const i=n.lastMessage,s=e.lastMessage;if(i.body!==s.body)return!0;if(i.conversation.id!==s.conversation.id)return!0;if(i.isByMe!==s.isByMe)return!0;if(i.read!==s.read)return!0;if(i.timestamp!==s.timestamp)return!0;if(i.type!==s.type)return!0}return!1}ee(e){const t=e.map((e=>{const t=this.makeMessage(e);return{lastMessage:t,unreadMessageCount:e.side.unreadMessageCount,conversation:t.conversation}}));this.G&&!this.ue(t,this.G)||this.Y.emit("change",t),this.G=t}ne(e){for(let t of e)this.U(this.makeMessage(t))}te({side:e,sender:t}){if(!this.J.isLeader)return;const n=Date.now();if(null!==e.lastMessageSenderId&&null!==t){this.ce={body:this.le(e),title:t.name};const i=Date.now()-n,s=()=>this.B(this.makeConversation(e));!function(e,t=500,n){!W&&V()&&(G+100>Date.now()||(W=!0,setTimeout((()=>{try{if(!document.hasFocus()){const t=e();t&&Y(t,n)}}finally{W=!1,G=Date.now()}}),t)))}((()=>this.ce),Math.max(0,500-i),s)}}fe(e){return function(t){let n,i=[];for(e.lastIndex=0;n=e.exec(t);){const e=n[0],t=n.index;i.push({offset:t,matchedText:e,regexMatch:n})}return i}}le(e){if("text"===e.lastMessageType){if("rest"===e.lastMessageOrigin){this.fe(/<((?:https?|mailto):.*?)\|(.*?)>/gi)(e.lastMessageBody).forEach((t=>{e.lastMessageBody=e.lastMessageBody.replace(t.regexMatch[0],t.regexMatch[2])}))}return e.lastMessageBody}if("location"===e.lastMessageType)return"📍 Shared location";if("media"===e.lastMessageType&&e.lastMessageAttachment){const{url:t}=e.lastMessageAttachment,n=Object(b.g)(t);return Object(b.h)(n)?`📷 ${n}`:`[↓] ${n}`}return""}makeMessage({side:e,sender:t}){let n,i;return null===t?(n=null,i=null):(n=t.externalId,i=K.f(t)),{id:e.lastMessageExternalId,conversation:this.makeConversation(e),isByMe:e.isByMe,senderId:n,sender:i,body:e.lastMessageBody,type:e.lastMessageType,timestamp:e.lastMessageTs,read:e.lastMessageRead,origin:e.lastMessageOrigin,custom:e.lastMessageCustom,attachment:e.lastMessageAttachment,location:e.lastMessageLocation}}makeConversation(e){const t=K.c(e.participants[e.meId]),n={};return"Read"!==t&&"ReadWrite"!==t||(n[this.externalMeId]={access:t}),{id:e.conversationExternalId,custom:e.conversationCustom,topicId:e.conversationTopicId,subject:e.conversationSubject,welcomeMessages:e.conversationWelcomeMessages,photoUrl:e.conversationPhotoUrl,participants:n}}on(e,t){this.M(),this.Y.on(e,t)}off(e,t){this.Y.off(e,t)}onChange(e){return this.M(),this.Y.subscribe("change",e)}M(){if(this.q)throw new Error("[TalkJS] This object has been destroyed, please create a new Session.")}pe(){var e;this.q=!0,null===(e=this.ie)||void 0===e||e.disconnect(),this.Y.removeAllListeners()}}class ie{constructor(e,t){e.then((e=>e.getOrJoinChannel(`me:${e.me.internalId}:${t}`))).catch((()=>{}))}}var se=n(67),oe=n(76);class re{constructor(e,t,n){this.ie=e,this.re=this.ie.getOrJoinChannel(`record/${t}/${n}`),this.loaded=new Promise(((e,t)=>{this.re.push("get",{}).receive("ok",(t=>{this.value=t.data,e()})).receive("error",(e=>t(e))).receive("timeout",(()=>t("timeout"))),this.re.on("recordUpdated",(e=>this.value=e.data))}))}}class ae{constructor(e,t,n,i,o,r=0){var a,u;this.authProvider=e,this.me=t,this.appId=n,this.appLocale=i,this.ve=o,this.version=r,this.ge={},this.be=new se.a((a=s.b,u=s.a,`${a.replace("http:","ws:").replace("https:","wss:")}//${u}`),{appId:this.appId}),e.getToken().then((t=>{this.be.connect({authToken:t}),e.onTokenRefreshFailed((()=>this.be.disconnect())),e.onReconnectPhoenixSockets((e=>{this.be.setAuth(e)}))}))}setAuth(e){this.be.setAuth(e)}url(e){return ue(this.appId,e,this.version)}getNym(e){e in this.ge||(this.ge[e]=new re(this,"nyms",e));const t=this.ge[e];return t.loaded.then((()=>t.value))}async post(e,t){return E({method:"POST",url:this.url(e),data:JSON.stringify(t),authProvider:this.authProvider})}async put(e,t){return E({method:"PUT",url:this.url(e),data:JSON.stringify(t),shouldRetry:ce,authProvider:this.authProvider})}async delete(e,t){return E({method:"DELETE",url:this.url(e),data:JSON.stringify(t),shouldRetry:ce,authProvider:this.authProvider})}getOrJoinChannel(e,t={}){const n=Object.assign(Object.assign({},t),{origin:"JSSDK"});return this.be.getOrJoin(e,n)}sendMessage({text:e,custom:t},n){const i=this.ve,s={text:e,custom:t,nymId:this.me.internalId,idempotencyKey:Object(oe.a)(Date.now())};return this.post(`/say/${n}/?sessionId=${i}`,s).then((e=>e.json())).then((({id:e})=>{0}))}leaveConversation(e){const t=this.me.internalId;return this.delete(`/conversations/${e}/participants/${t}`).then((e=>!0),(e=>{if(e&&403===e.status)return!1;throw e}))}markConversationAsUnread(e){const t=this.me.id;return this.delete(`/conversations/${e}/unreadBy/${t}`).then((e=>!0),(e=>{if(e&&403===e.status)return!1;throw e}))}disconnect(){this.be.disconnect()}}function ue(e,t,n=0){return`${s.b}//${s.a}/api/v${n}/${e}/${t}`}function ce(e){return!(e instanceof Response&&e.status>=400&&e.status<500)}var he=n(57);class le{constructor(e,t,n){this.Te=e,this.getSourceWindow=t,this.$=n,this.router=e=>he.a(e,{sourceWindow:this.getSourceWindow(),handlers:this.$});for(const e in n)this.listen(e,n[e])}initialise(){window.addEventListener("message",this.router)}destroy(){window.removeEventListener("message",this.router)}listen(e,t){this.$[e]=(...e)=>t.apply(this.Te,e)}unlisten(...e){for(const t of e)delete this.$[t]}}const fe=[[2,1],[2],[],[3,4,5]];class de{constructor(e,t,n,i){this.Oe=e,this.ke=t,this.initialPath=n,this.queryStringData=i,this.we=!1,this.ye=b.e(),this.nav=async(e,t={},n)=>{const i=new pe(Object.assign(Object.assign({},this.queryStringData),{dbSyncData:t,localSettings:n}));this.we?await this.ask("nav",this.Ie(e),i.toString()):this._e(e,i)},this.mount=(e,t)=>{e!==this.Se&&(this.Se=e,this.Ee(),t(this.Ae.style))},this.Ne=`${s.b}//${s.a}`,this.Ae=document.createElement("iframe"),this.Ae.scrolling="no",this.Ae.name="____talkjs__chat__ui_internal",this.Ae.style.border="none",this.Ae.setAttribute("aria-label","Chat"),this.Ae.allow="fullscreen;microphone",this.Ae.style.colorScheme="normal",this.Ae.style.border="0px",this.Pe(this.Ae);const o=new pe(this.queryStringData);this._e(this.initialPath,o),_("__talkjs:appready",(()=>{this.ye.resolve(void 0)}))}Pe(e){e.onload=e=>{this.we=!0}}De(e){return`${this.Ne}/app/${this.Oe}${this.Ie(e)}`}Ie(e){return`/user/${this.ke}/${e}`}contentWindow(){return this.Ae.contentWindow}post(e,...t){return this.ye.promise.then((()=>{this.Ce()&&he.c(e,t,this.Ae.contentWindow)}))}ask(e,...t){return this.ye.promise.then((()=>{if(!this.Ce())throw new me("[TalkJS] Attempted to operate on a UI object that does not exist any more. This object has been deleted before (either by calling destroy(), by a user closing the popup, or by external code removing the TalkJS Iframe from the DOM), and is now in an invalid state.");return he.b(e,t,this.Ae.contentWindow)}))}async patchQueryString(e){try{await this.ask("patchQueryString",e)}catch(e){if("IFrameLostError"===e.name)return;throw e}}async reconnectPhoenixSockets(e){try{await this.post("reconnectPhoenixSockets",e)}catch(e){if("IFrameLostError"===e.name)return;throw e}}_e(e,t){let n=t.toString();if(n.length>b.a){const{short:e,long:i,key:s}=t.split();E({method:"PUT",url:`${this.Ne}/app/${this.Oe}/__buffer/${s}`,data:JSON.stringify({value:i}),attempts:3}),n=`bufferKey=${s}&${e}`}this.Ae.src=this.De(`${e}?${n}`)}patchLocalSettings(e){return e.tokenRefreshFailed&&(this.Ae.style.pointerEvents="none",this.Ae.blur()),this.patchQueryString({localSettings:e})}Ee(){this.Se.appendChild(this.Ae)}cleanupContainer(){if(this.Ce()&&this.Se.hasChildNodes()){for(;this.Se.firstChild&&this.Se.firstChild!==this.Ae;)this.Se.firstChild.remove();for(;this.Se.lastChild&&this.Se.lastChild!==this.Ae;)this.Se.lastChild.remove()}}destroy(){this.Ae.remove()}isZombie(){return!!this.we&&!this.Ce()}Ce(){return document.body.contains(this.Ae)}}class pe extends b.b{constructor({dbSyncData:e,localSettings:t,clientHeight:n,signature:i,authToken:s,externalUserId:o,thirdparties:r,sessionId:a}){let u=[];e&&u.push(["syncPlease",e]),t&&u.push(["localSettings",t]),i&&u.push(["signature",i]),s&&u.push(["authToken",s]),u.push(["clientHeight",n]),u.push(["sessionId",a]),u.push(["thirdparties",r]),u.push(["id",o]),super(u)}}class me extends Error{constructor(e){super(e),this.name="IFrameLostError"}}var ve=n(13);function ge(e,t,n=[]){const i=document.createElement(e),{style:s}=t,o=Object(ve.d)(t,["style"]);Object.assign(i,o),Object.assign(i.style,s);for(let e of n)i.appendChild(e);return i}function be(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("width","30"),e.setAttribute("height","30"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.setAttribute("stroke","currentColor"),e.setAttribute("stroke-width","2"),e.setAttribute("stroke-linecap","round"),e.setAttribute("stroke-linejoin","round"),e.setAttribute("class","feather feather-x");const t=document.createElementNS("http://www.w3.org/2000/svg","line");t.setAttribute("x1","18"),t.setAttribute("y1","6"),t.setAttribute("x2","6"),t.setAttribute("y2","18");const n=document.createElementNS("http://www.w3.org/2000/svg","line");return n.setAttribute("x1","6"),n.setAttribute("y1","6"),n.setAttribute("x2","18"),n.setAttribute("y2","18"),e.appendChild(t),e.appendChild(n),e}var Te=n(106);const Oe=100,ke=!0,we=(e,t)=>{if(n=e,isNaN(parseFloat(n))||!isFinite(n))throw new Error(`[TalkJS][HtmlPanel] ${t||"value"} must be a number.`);var n;return Number(e)};class ye{constructor(e,t){if(this.Me=!1,this.panelLoaded=Object(b.e)(),this.je=Object(b.e)(),this.Re=Object(b.e)(),!t.url)throw new Error("[TalkJS] URL is required for the `HTMLPanel`.");const{url:n,show:i=ke,height:s=Oe,conversation:o}=t,r=document.createElement("a");r.href=n,this.Fe={url:r.href,show:i,height:we(s,"height"),conversation:"object"==typeof o?o.id:o},this.$e=e,this.DOMContentLoadedPromise=this.je.promise,this.windowLoadedPromise=this.Re.promise}show(){this.M(),!1===this.Fe.show&&(this.Fe.show=!0,this.xe())}hide(){this.M(),!0===this.Fe.show&&(this.Fe.show=!1,this.xe())}setHeight(e){this.M(),this.Fe.height=we(e,"height"),this.xe()}isVisible(){return this.M(),!this.Me&&!0===this.Fe.show}M(){if(this.$e.M(),this.Me)throw new Error("[TalkJS] This HTML Panel has been destroyed, and you cannot use it anymore. Please create a new HTML Panel.")}destroy(){return this.Fe.show=!1,this.Fe.url="",this.Me=!0,this.xe()}Ke(){const e=Object(b.d)(this.Fe.url,this.$e.sessionId,this.Fe.conversation);return _(`__talkjs:htmlPanelLoaded_${e}`,(()=>{this.panelLoaded.resolve(void 0)})),this.xe().then((()=>this.panelLoaded.promise.then((()=>{const t=this.Ue(e);if(!t)throw new Error("[TalkJS][HtmlPanel]: Couldn't get a reference to the window property of the HTML panel iframe.");this.window=t;try{this.window.scrollBy(0,0)}catch(e){return void console.warn(`[TalkJS] HTML Panel on url ${this.Fe.url} is not on the same origin as the current page, functionality may be limited. DOMContentLoadedPromise and windowLoadedPromise will never resolve. See https://talkjs.com/docs/Features/Customizations/HTML_Panels.html#page_HTML-Panel-Limitations for more information.`)}const n=(e,t)=>{t.resolve(void 0)},i=()=>this.window.addEventListener("load",(()=>n(0,this.Re)),!0),s=()=>this.window.document.addEventListener("DOMContentLoaded",(()=>n(0,this.je)),!0);"loading"===this.window.document.readyState?(s(),i()):"complete"===this.window.document.readyState?(n(0,this.je),n(0,this.Re)):(n(0,this.je),i())}))))}xe(){return this.$e.contentLoaded().then((()=>this.$e.Be()))}Ue(e){const t=this.Je();return null!==t?t.frames[e]:null}Je(){const e=this.$e.Le();return e||null}}class Ie{constructor(e){this.$e=e}focus(){this.$e.He("focusMessageField")}setText(e){this.$e.He("setText",e)}typeText(e){this.$e.He("typeText",e)}getText(){return this.$e.Ye("getText")}setVisible(e){this.$e.ze("messageField",{visible:e})}}function _e(e,t){const n=t||{},{hasUnreadMessages:i,custom:s,access:o,subject:u,lastMessageTs:c}=n,h=Object(ve.d)(n,["hasUnreadMessages","custom","access","subject","lastMessageTs"]);r(i,["boolean","undefined"],`${e}.hasUnreadMessages must be boolean.`),Ee(`${e}.access`,o,["ReadWrite","Read","None"]),Ne(`${e}.custom`,s),Ae(`${e}.subject`,u,void 0,["string","null"]),function(e,t){const n=`${e} must be a valid predicate. See the docs for all available options.`;if(r(t,["string[]","undefined"],n),!t)return;if(2!==t.length)throw new Error("[TalkJS] "+n);const[i,s]=t;if(a(i,[">","<",">=","<=","between","!between"],n),"between"===i||"!between"===i){if(r(s,["number[]"],n),2!==s.length)throw new Error("[TalkJS] "+n);const[e,t]=s;if(r(t,["number"],n),e>=t)throw new Error("[TalkJS] "+n)}else r(s,["number"],n)}(`${e}.lastMessageTs`,c);for(let t in h)console.warn(`[TalkJS] ${e}.${t} is not a valid field.`)}function Se(e,t){const n=t||{},{origin:i,type:s,custom:o,sender:r}=n,a=Object(ve.d)(n,["origin","type","custom","sender"]);Ee(`${e}.origin`,i,["web","rest","email","import"]),Ee(`${e}.type`,s,["SystemMessage","UserMessage"]),function(e,t){const n=t||{},{id:i,locale:s,role:o,custom:r}=n,a=Object(ve.d)(n,["id","locale","role","custom"]);Ee(`${e}.id`,i),Ee(`${e}.locale`,s),Ee(`${e}.role`,o),Ne(`${e}.custom`,r);for(let t in a)console.warn(`[TalkJS] ${e}.${t} is not a valid field.`)}(`${e}.sender`,r),Ne(`${e}.custom`,o);for(let t in a)console.warn(`[TalkJS] ${e}.${t} is not a valid field.`)}function Ee(e,t,n){return Ae(e,t,n,["string"])}function Ae(e,t,n,i){r(t,["string[]","undefined"],`${e} must be a valid predicate. See the docs for all available options.`),t&&Pe(e,t,n,i)}function Ne(e,t){if(r(t,["object","undefined"],`${e} must be an object.`),t)for(let n of Object.getOwnPropertyNames(t)){Pe(`${e}.${n}`,t[n])}}function Pe(e,t,n,i=["string"]){const s=`${e} must be a valid predicate. See the docs for all available options.`;if("string"==typeof t)return void a(t,["exists","!exists"],s);if(2!==t.length)throw new Error("[TalkJS] "+s);const[o,u]=t;if(a(o,["==","!=","oneOf","!oneOf"],s),"oneOf"===o||"!oneOf"===o){if(r(u,i.map((e=>`${e}[]`)),s),n)for(let e of u)a(e,n,s)}else r(u,i||["string"],s),n&&a(u,n,s)}var De=n(37),Ce=n(256);const Me={sendMessage(e){},focus(){},blur(){},translationToggled(e){},keyup(e){},keydown(e){},customMessageAction(e){},customConversationAction(e){},leaveConversation(e){},markConversationAsUnread(e){}};class je{constructor(e,{selectedConversation:t,hideHub:n=!1}={},i,s){this.C=e,this.We=new le(this,(()=>{var e;return null===(e=this.Ge)||void 0===e?void 0:e.contentWindow()}),{getCurrentLocation:this.qe,showMoreChats:this.Ve,sendMessage:this.Xe,leaveConversation:this.Qe,markConversationAsUnread:this.Ze,uiBoxFocusChange:this.tt,translationToggled:this.nt,customMessageAction:this.st,customConversationAction:this.ot,selectedConversationChanged:this.rt,keyup:this.ut,keydown:this.ct,hasParentFocus:this.ht,showImagePopup:this.lt,openExternalLink:this.ft,refreshAuth:this.dt,emitBrowserPermissionNeeded:this.vt,emitBrowserPermissionDenied:this.gt,selectConversation:e=>({stop:!1}),desktopNotifyChanged:e=>{},closePopover:()=>{}}),this.bt={perConv:Object.create(null)},this.Tt=b.e(),this.Y=new Z(Me),this.sessionId=I(),this.messageField=new Ie(this),this.isAlive=!0;let{dir:o}=s;!o&&document.documentElement.dir&&"auto"!==document.documentElement.dir&&(o=document.documentElement.dir),this.Ot={hideHub:n,dir:o},this.boxType=i,this.kt=Object.assign({},s),this.select(t);const r=this.C.authProvider.onTokenChanged((e=>this.wt({authToken:e}))),a=this.C.authProvider.onTokenRefreshFailed((()=>this.yt({tokenRefreshFailed:!0}))),u=this.C.authProvider.onReconnectPhoenixSockets((e=>this.It(e)));this.unsubscribeAuth=()=>{r(),a(),u()}}contentLoaded(){return this.Tt.promise}async select(e,t={}){k({conversation:e,selectOptions:t}),r(e,["null","undefined","string","object"],"Expected 1st parameter to `select` to be a conversation ID, a ConversationBuilder, null, or undefined. More info on https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Chatbox.html#Chatbox.select",[j]),this.M();const n=this.kt,s=this.kt,a=this.kt,u=n.messageField||{};if(n.messageField&&void 0!==n.messageField.visible&&"boolean"!=typeof n.messageField.visible&&_e("messageField.visible",n.messageField.visible),n.theme&&(r(n.theme,["string","object"],'The "theme" option should either be a string (the theme name), or an object with optional "name" and "custom" fields.'),"object"==typeof n.theme&&(r(n.theme.name,["string","undefined"],'The "name" field of them "theme" options object must be a string, or undefined.'),n.theme.custom)))try{JSON.stringify(n.theme.custom)}catch(e){throw new o(i.ARGUMENT_INVALID,"theme.custom must be a JSON-serializable value.")}this._t={desktopNotify:V(),dir:this.Ot.dir,htmlPanelOptions:this.St(),feedFilter:void 0===s.feedFilter?{}:s.feedFilter,messageFilter:void 0===s.messageFilter?{}:s.messageFilter,useBrowserHistory:void 0===s.useBrowserHistory||s.useBrowserHistory,translationOptions:this.Et(),highlight:[],chatHeaderState:"profile",theme:"string"==typeof s.theme?{name:s.theme}:s.theme,presence:this.kt.presence,messageField:{enterSendsMessage:void 0===u.enterSendsMessage||u.enterSendsMessage,placeholder:u.placeholder,spellcheck:void 0!==u.spellcheck&&u.spellcheck,visible:void 0===u.visible||u.visible,autofocus:!1!==u.autofocus},view:{mode:this.getMode(a),isInsideMobileApp:!!window.cordova,captureKeyboardEvents:!!n.captureKeyboardEvents,showChatHeader:void 0===n.showChatHeader||n.showChatHeader,showFeedHeader:void 0===s.showFeedHeader||s.showFeedHeader,searchInConv:this.C.At(3),chatTitleMode:void 0===n.chatTitleMode?"participants":n.chatTitleMode,chatSubtitleMode:void 0===n.chatSubtitleMode?"subject":null===n.chatSubtitleMode?"none":n.chatSubtitleMode,feedConversationTitleMode:void 0===s.feedConversationTitleMode?"auto":s.feedConversationTitleMode,showCloseInHeader:void 0===a.showCloseInHeader?"auto":a.showCloseInHeader,legacyNoChatsPage:this.C.At(2),timeZone:Ce.determine().name(),showMobileBackButton:void 0===s.showMobileBackButton||s.showMobileBackButton},tokenRefreshFailed:!1},this.Nt=this.Pt(e),this.S=this.Dt(e,t),this.Ge&&await this.Ge.nav(this.S,this.Nt,this._t);const c=t.messageSuggestion||n.messageSuggestion;c&&await this.He("setText",c)}createHtmlPanel(e){k({options:e});this.M();const t=new ye(this,e),n=e.conversation;n?this.bt.perConv["object"==typeof n?n.id:n]=t:this.bt.global=t;const i=t.Ke();return this.Be(),i.then((()=>t))}setTranslationEnabledForConversation(e,t){let n;k({conversation:e,enabled:t}),n="string"==typeof e?x(e):e.internalId,this._t.translationOptions.perConv[n]=t,this.yt({translationOptions:this._t.translationOptions})}setTranslationEnabledDefault(e){k({shouldTranslate:e}),this._t.translationOptions.global=e,this.yt({translationOptions:this._t.translationOptions})}on(e,t){k({eventType:e,handler:t}),this.M(),this.Y.on(e,t)}off(e,t){k({eventType:e,handler:t}),this.Y.off(e,t)}onCustomMessageAction(...e){const[t,n]=1===e.length?[void 0,e[0]]:e;k({action:t,handler:n}),this.M();return this.Y.subscribe("customMessageAction",(e=>{void 0!==t&&e.action!==t||n(e)}))}onCustomConversationAction(...e){const[t,n]=1===e.length?[void 0,e[0]]:e;k({action:t,handler:n}),this.M();return this.Y.subscribe("customConversationAction",(e=>{void 0!==t&&e.action!==t||n(e)}))}onSendMessage(e){return k({handler:e}),this.M(),this.Y.subscribe("sendMessage",e)}onLeaveConversation(e){return k({handler:e}),this.M(),this.Y.subscribe("leaveConversation",e)}onMarkConversationAsUnread(e){return k({handler:e}),this.M(),this.Y.subscribe("markConversationAsUnread",e)}onFocus(e){return k({handler:e}),this.M(),this.Y.subscribe("focus",e)}onBlur(e){return k({handler:e}),this.M(),this.Y.subscribe("blur",e)}onTranslationToggled(e){return k({handler:e}),this.M(),this.Y.subscribe("translationToggled",e)}onKeyup(e){return k({handler:e}),this.M(),this.Y.subscribe("keyup",e)}onKeydown(e){return k({handler:e}),this.M(),this.Y.subscribe("keydown",e)}Ct(e,t){return P(this.kt,e),this.yt(t)}yt(e){return P(this._t,e),this.contentLoaded().then((()=>this.Ge.patchLocalSettings(e)))}wt(e){return this.contentLoaded().then((()=>this.Ge.patchQueryString(e)))}It(e){return this.contentLoaded().then((()=>this.Ge.reconnectPhoenixSockets(e)))}Mt(e){return this.contentLoaded().then((()=>{const t=this.Ge;if(null==t?void 0:t.isZombie())throw new Error(e||"[TalkJS] Attempted to operate on a UI object that does not exist any more. This object has been deleted before (either by calling destroy(), by a user closing the popup, or by external code removing the TalkJS Iframe from the DOM), and is now in an invalid state. Please call createInbox, createChatbox or createPopup again. See the attached stack trace for more information on the operation that failed.");return t}))}He(e,...t){return this.Mt().then((n=>n.post(e,...t)))}Ye(e,...t){return this.Mt().then((n=>n.ask(e,...t)))}ze(e,t){P(this._t[e],t);const n={[e]:this._t[e]};return this.contentLoaded().then((()=>this.Ge.patchLocalSettings(n)))}setPresence({visible:e,custom:t}={}){k({visible:e,custom:t}),this.M(),r(e,["undefined","boolean"],"UIBox.setPresence: field visible has to be boolean."),t&&u(t,["string"],(e=>`UIBox.setPresence: Field "custom.${e}" must be a string.`));const n={visible:e,custom:t};this.Ct({presence:n},{presence:n}),this.He("setPresence",n)}sendFile(e){k({file:e});return this.M(),r(e,["object"],"UIBox.sendFile: parameter file must be a File object and its name must have a file extension",[e=>{if(e instanceof File){const t=e.name.split(/[\\/]/).pop();return!(""===t||t.lastIndexOf(".")<1)}return!1}]),this.Ye("sendFile",e)}sendLocation(){k();return this.M(),this.Ye("sendLocation")}setHighlightedWords(e){k({words:e});return this.yt({highlight:e})}jt(e){return this.Y.supports(e)}Le(){return this.Ge?this.Ge.contentWindow():null}Pt(e){const t={me:this.C.me};return"object"==typeof e&&null!==e&&(t.others=e.participants.filter((e=>e.user.id!==this.C.me.id)).map((e=>e.user)),t.conversation={internalId:e.internalId,id:e.id,participants:e.participants,subject:e.subject,custom:e.custom,welcomeMessages:e.welcomeMessages,photoUrl:e.photoUrl,topicId:e instanceof R?e.topicId:void 0}),t}Dt(e,t){if(null===e)return"inbox/chats/hubOnly";const n=this.Ot.hideHub?"chatbox":"inbox";if(e){const i=t.asGuest?"/g":"";return`${n}/${"string"==typeof e?x(e):e.internalId}${i}`}return`${n}/chats`}M(){if(this.C.M(),!this.isAlive)throw new Error("[TalkJS] This UI object has been destroyed, and you cannot use it anymore. This object has been deleted before (either by calling destroy(), by a user closing the popup, or by external code removing the TalkJS Iframe from the DOM), and is now in an invalid state. Please call createInbox, createChatbox or createPopup again.")}Rt(e){k({container:e});this.M();const t=e,n=t&&t.jquery&&t.length?t[0]:e;if(this.Ge)throw new Error("[TalkJS] Cannot mount UI more than once. Please call createInbox, createChatbox or createPopup again if you want to create a new UI.");if(!n||!n.tagName)throw new Error("[TalkJS] Cannot mount UI: container element not found");if(!this.S)throw new Error("[TalkJS] Internal Error: cannot mount UI without URL");const i=this.C.legacyThemePath;return i?E({method:"GET",url:i}).then((e=>e.text())).then((e=>this._t.rawV1Theme=e.replace(/\/\*[^@]+?\*\//gm,""))).then((()=>this.mountIframe(n))):this.mountIframe(n)}Et(){return this._t&&this._t.translationOptions?this._t.translationOptions:("auto"!==this.kt.translateConversations&&r(this.kt.translateConversations,["object[]","string[]","boolean","undefined"],"translateConversations should either be a boolean or an array of ConversationBuilders or conversation ids as strings."),"auto"!==this.kt.showTranslationToggle&&r(this.kt.showTranslationToggle,["boolean","undefined"],'showTranslationToggle should either be a boolean or "auto".'),Array.isArray(this.kt.translateConversations)?{global:!1,perConv:Object(De.b)(this.kt.translateConversations,(e=>"string"==typeof e?[x(e),!0]:[e.internalId,!0])),showToggle:this.kt.showTranslationToggle||!1}:{global:this.kt.translateConversations||!1,perConv:{},showToggle:this.kt.showTranslationToggle||!1})}St(){const e=e=>({show:e.show,url:e.url,height:e.height}),{global:t,perConv:n}=this.bt;let i={perConv:{}};t&&(i.global=e(t.Fe));for(let t in n)i.perConv[t]=e(n[t].Fe);return i}Be(){this.yt({htmlPanelOptions:this.St()})}Ft(){this.We.initialise()}async mountIframe(e){const t={};if(this.C.authProvider.shouldMountFrontendWithSignature)t.signature=this.C.signature;else{const e=await this.C.authProvider.getToken();t.authToken=e}const{height:n}=Object(Te.a)(),i=Object.assign({dbSyncData:this.Nt,localSettings:this._t,clientHeight:n,sessionId:this.sessionId,thirdparties:this.kt.thirdparties,externalUserId:this.C.me.id},t);if(this.Ge=new de(this.C.appId,this.C.me.internalId,this.S,i),this.$t(),this.Ft(),"full"===this._t.view.mode){let t;if(this.C.At(1)){const n=function(e){const t=document.createElement("div");Re(e,t);const n=e.style.boxSizing;e.style.boxSizing="content-box";const i=parseInt(getComputedStyle(e).height);return e.style.boxSizing=n,Re(t,e),i>1}(e);t=t=>{t.width="100%",this.xt(e,t,n),t.marginLeft="auto",t.marginRight="auto",t.visibility="visible",t.outline="none","ti8AJFWH"!==this.C.appId&&"LfC1CcQC"!==this.C.appId&&(t.minHeight="500px")}}else t=e=>{e.width="100%",e.height="100%",e.marginLeft="auto",e.marginRight="auto",e.visibility="visible",e.outline="none"};this.Ge.mount(e,t)}else this.Ge.mount(e,(e=>{e.width=e.height="0",e.minWidth=e.maxWidth=e.minHeight=e.maxHeight="100%",e.visibility="visible"}));await Promise.race([this.Tt.promise,new Promise(((e,t)=>setTimeout(t,6e4)))]).catch((async()=>{w.log("IFrame mount timed out, iframe failed to load."),console.error("[TalkJS]: .mount has taken over 60 seconds, which should not happen. There may be other messages in the console explaining what went wrong. If there aren't any other errors and you're on a fast connection, TalkJS may be experiencing downtime. Continuing trying to load.");const e=(new Date).getTime();await this.Tt.promise;const t=(6e4+(new Date).getTime()-e)/1e3;w.log(`IFrame loaded after timeout, total load time ${t}s.`),console.error(`[TalkJS]: UI did eventually load after ${t} seconds. You are probably on a very slow connection.`)}))}xt(e,t,n){if(n)return void(t.height="100%");const i=e.getBoundingClientRect().top+window.pageYOffset,s=window.innerHeight;let o=s-i,r=0;if(window.innerWidth>=1010){const t=getComputedStyle(e);r=parseInt(t.paddingTop)+parseInt(t.paddingBottom)||10,o-=r}t.height=o>500?Math.round(o)+"px":Math.round(.75*s)+"px"}$t(){_("__talkjs:hello",(()=>{this.Ge.cleanupContainer(),this.Tt.resolve(void 0)}))}lt({url:e}){!function(e){const t=document.getElementById("___talkjs_image_popup");t&&t.parentNode.removeChild(t);const n=Math.min(window.innerWidth,window.innerHeight)<500?{padding:"0",maxWidth:"100%",maxHeight:"100%"}:{padding:"5px",maxWidth:"95%",maxHeight:"95%",background:"#fff"},i=ge("div",{tabIndex:-1,style:{boxSizing:"border-box",padding:"0",backgroundColor:"rgba(0,0,0,0.85)",opacity:"0",transition:"opacity 0.2s ease-out",overflow:"hidden",position:"fixed",zIndex:"54321",left:"0",top:"0",right:"0",bottom:"0"}},[ge("img",{src:e,style:Object.assign(Object.assign({},n),{opacity:"0",transition:"opacity 0.1s ease-out",margin:"auto",position:"absolute",top:"0",bottom:"0",right:"0",left:"0"})}),ge("span",{style:{cursor:"pointer",color:"#fff",font:"sans-serif",position:"absolute",right:"0",top:"0",padding:"1rem"}},[be()])]);let s;const o=e=>{e.preventDefault(),i.parentNode.removeChild(i),document.body.removeEventListener("keydown",s)};s=e=>27===e.keyCode&&o(e),i.addEventListener("click",o),document.body.addEventListener("keydown",s);const r=window.requestAnimationFrame||(e=>setTimeout(e,20));r((()=>r((()=>i.style.opacity="1")))),i.getElementsByTagName("img")[0].onload=e=>e.target.style.opacity="1",document.body.appendChild(i),i.focus()}(e)}tt({focused:e}){this.Y.emit(e?"focus":"blur",{})}nt({conversation:e,isEnabled:t,externalNymIds:n}){this.Y.emit("translationToggled",{isEnabled:t,conversation:K.d(e,n)})}ut(e){this.Y.emit("keyup",e)}ct(e){this.Y.emit("keydown",e)}vt(e){return this.C.vt(e)}gt(e){return this.C.gt(e)}rt(e){null!==e.conversation?this.currentConversation=K.d(e.conversation,e.externalNymIds):this.currentConversation=null}st({action:e,conversation:t,message:n,sender:i,params:s,externalNymIds:o}){this.Y.emit("customMessageAction",{action:e,params:s,message:K.e(n,t,i,this.C.me.internalId,o)})}ot({action:e,conversation:t,params:n,externalNymIds:i}){this.Y.emit("customConversationAction",{action:e,params:n,conversation:t&&i&&K.d(t,i)})}Qe({conversation:e,externalNymIds:t}){const n=K.d(e,t);let i=!1,s=!1;return this.Y.emit("leaveConversation",{conversation:n,preventDefault(){i&&console.warn("[TalkJS] Calling LeaveConversationEvent.preventDefault() after the event has completed. This has no effect, make sure you only call preventDefault directly from the event handler."),s=!0}}),i=!0,{prevent:s}}Ze({conversation:e,externalNymIds:t}){const n=K.d(e,t);let i=!1,s=!1;return this.Y.emit("markConversationAsUnread",{conversation:n,preventDefault(){i&&console.warn("[TalkJS] Calling MarkConversationAsUnread.preventDefault() after the event has completed. This has no effect, make sure you only call preventDefault directly from the event handler."),s=!0}}),i=!0,{prevent:s}}Xe({me:e,conversation:t,text:n,entityTree:i,attachment:s,location:o,externalNymIds:a}){if(!this.Y.handles("sendMessage"))return;const c=K.f(e),h=K.d(t,a),l={id:void 0,conversationId:t.id,type:"UserMessage",readBy:[],senderId:e.id,text:n,entityTree:i,origin:"web",attachment:s,location:o,createdAt:void 0};let f={text:n,custom:{}};const d=new D("SendMessageEvent.override",(({text:e,custom:t})=>{r(e,["string","undefined"],`'text' should be a single string value representing the text of the message, got: \`${e}\``),r(t,["object","undefined"],`'custom' should be an object whose keys and values are all strings, got: \`${t}\``),u(t,["string"],(e=>`Field "custom.${e}" must be a string.`)),e&&(f.text=e),t&&(f.custom=t)})),p={me:c,message:l,conversation:h,override:d.callback};return this.Y.emit("sendMessage",p),d.expire(),f}async qe(){return"cancel"===await this.vt("geolocation")?"cancel":new Promise(((e,t)=>{navigator.geolocation.getCurrentPosition((t=>e([t.coords.latitude,t.coords.longitude])),(n=>{if(n.code===GeolocationPositionError.PERMISSION_DENIED){if(this.gt("geolocation"))return void e("cancel")}t(n.message)}))}))}ft({url:e}){window.open(e,"_system","location=yes")}Ve({amount:e,lastChatTs:t}){this.C.Kt.ae({amount:e,lastChatTs:t})}ht(){return document.hasFocus()}async dt(){return this.C.authProvider.refreshToken(),this.C.authProvider.getToken()}toggleDesktopNotifications(e){k({isEnabled:e});return this.C.setDesktopNotificationEnabled(e)}Ut(e){return this.yt({desktopNotify:e})}destroy(){k(),this.unsubscribeAuth(),this.We.unlisten("showImagePopup","sendMessage","selectedConversationChanged"),this.We.destroy(),this.C.forgetUIBox(this),this.Y.removeAllListeners(),this.Ge&&this.Ge.destroy(),this.isAlive=!1}isZombie(){return!!this.Ge&&this.Ge.isZombie()}onWindowVisibleChanged(e){this.isZombie()||this.He("windowVisibleChanged",e)}getMode(e){switch(this.popupType(e)){case K.b.Widget:return"widget";case K.b.Popover:return"popover";default:return"full"}}popupType(e){}setMessageFilter(e){k({filter:e}),this.M(),Se("filter",e),this.Ct({messageFilter:e},{messageFilter:e})}}function Re(e,t){for(;e.hasChildNodes();)t.appendChild(e.firstChild)}class Fe extends je{constructor(e,t={},n){super(e,t,K.a.Inbox,n),this.Bt=new Z({selectConversation(e){},conversationSelected(e){},desktopNotificationToggled(e){}})}mount(e){return super.Rt(e)}select(e,t){if(null==t?void 0:t.asGuest)throw new Error("[TalkJS] Cannot select a conversation as guest in the Inbox UI. Please use a Popup or a Chatbox.");return super.select(e,t)}Ft(){this.We.listen("selectConversation",this.emitSelectConversation),this.We.listen("desktopNotifyChanged",this.handleDesktopNotifyChange),super.Ft()}emitSelectConversation(e){const t=K.f(e.me),n=K.d(e.conversation,e.externalNymIds);let i={stop:!1};const s=new D("SelectConversationEvent.preventDefault",(()=>{i.stop=!0})),o=e.participants.map((e=>K.f(e)));return this.Bt.emit("selectConversation",{conversation:n,me:t,others:K.h(t,o),participants:o,preventDefault:s.callback}),s.expire(),i}rt(e){super.rt(e);const t=K.f(e.me);if(null===e.conversation)return void this.Bt.emit("conversationSelected",{me:t,conversation:null,conversationId:null});const n=K.d(e.conversation,e.externalNymIds),i=K.g(e.conversation,e.participants),s=K.h(t,i);this.Bt.emit("conversationSelected",{me:t,conversation:n,other:s[0],others:s,participants:i,conversationId:e.conversation.id})}handleDesktopNotifyChange({isEnabled:e,appName:t}){this.C.Jt(e,{appName:t}).then((t=>{t?this.Bt.emit("desktopNotificationToggled",{isEnabled:e}):this.C.setDesktopNotificationEnabled(!1)}),(()=>{this.C.setDesktopNotificationEnabled(!1)}))}setFeedFilter(e){k({filter:e}),_e("filter",e),this.Ct({feedFilter:e},{feedFilter:e})}on(e,t){this.M(),super.jt(e)?super.on(e,t):this.Bt.on(e,t)}off(e,t){super.jt(e)?super.off(e,t):this.Bt.off(e,t)}onSelectConversation(e){return k({handler:e}),this.M(),this.Bt.subscribe("selectConversation",e)}onConversationSelected(e){return this.M(),this.Bt.subscribe("conversationSelected",e)}onDesktopNotificationToggled(e){return this.M(),this.Bt.subscribe("desktopNotificationToggled",e)}destroy(){this.We.unlisten("desktopNotifyChanged"),super.destroy(),this.Bt.removeAllListeners()}}class $e extends je{constructor(e,t,n){super(e,{hideHub:!0,selectedConversation:t},K.a.Popup,n),this.conversation=t,this.Lt=n,this.Ht=new Z({close(){},open(){}})}select(e,t){return this.conversation=e,t&&void 0!==t.asGuest&&r(t.asGuest,["boolean"],'Chatbox#select: field "asGuest" is given but not a boolean.'),super.select(e,t)}Ft(){this.We.listen("closePopover",this.Yt),super.Ft()}mount({show:e}={show:!0}){const t=this.zt(e),[n,i]=t;return document.body.insertBefore(n,document.body.firstChild),e||this.setPresence({visible:!1}),super.Rt(i).then((()=>{e&&this.Wt(t)}))}Yt(){if(!this.isAlive)throw new Error("[TalkJS] Can't hide a popup that's been destroyed. Please create and mount a new one.");const e=this.Gt();this.qt(e);this.Ht.emit("close",{})}destroy(){const e=this.Vt();e&&e[0]&&document.body.removeChild(e[0]),this.restorePageHeight(),this.forgetMe(),this.We.unlisten("closePopover"),this.C.forgetUIBox(this),super.destroy()}show(){k(),this.M();const e=this.Gt();this.Wt(e)}hide(){k(),this.M();const e=this.Gt();this.qt(e)}on(e,t){this.M(),super.jt(e)?super.on(e,t):this.Ht.on(e,t)}off(e,t){super.off(e,t),this.Ht.off(e,t)}onOpen(e){return this.M(),this.Ht.subscribe("open",e)}onClose(e){return this.M(),this.Ht.subscribe("close",e)}popupType(e){const t=null!=e?e:this.Lt;if("widget"===t.popupType)return K.b.Widget;if("popover"===t.popupType)return K.b.Popover;const{width:n,height:i}=Object(Te.a)();return n<420||i<420?K.b.Popover:K.b.Widget}Vt(){const e=document.getElementById("__talkjs_popup_container_"+this.sessionId);if(!e)return;const t=e.getElementsByTagName("span")[0],n=e.getElementsByClassName("__talkjs_launcher")[0];return[e,t,n]}Gt(){const e=this.Vt();if(!e){throw Error(`[TalkJS] ${"Unexpected error: Could not find popup container. Maybe something, other than TalkJS, removed it from the DOM?"}`)}return e}Wt([e,t,n]){var i;const s=this.C.Xt(K.a.Popup);for(let e of s)this!==e&&e.hide();t.style.display="",n&&(n.className=n.className.replace("closed","open"),n.style.display="",n.setAttribute("aria-label","Close chat popup")),e.style.display="",this.rememberMe(),this.popupType()===K.b.Popover&&this.fixPageHeight(e),this.setPresence({visible:!0}),(null===(i=this.kt.messageField)||void 0===i?void 0:i.autofocus)&&this.messageField.focus()}qt([e,t,n]){"always"===this.Lt.launcher?(t.style.display="none",n&&(n.className=n.className.replace("open","closed"),n.setAttribute("aria-label","Open chat popup"))):e.style.display="none",this.restorePageHeight(),this.forgetMe(),this.setPresence({visible:!1})}zt(e){const t=document.createElement("span"),i=document.createElement("link");i.type="text/css",i.rel="stylesheet";const s=n(370);i.href=s;const o=document.createElement("div");let r;o.id="__talkjs_popup_container_"+this.sessionId,t.style.display="none",t.className="__talkjs_popup",o.appendChild(i),o.appendChild(t);let a=[o,t,void 0];return"never"!==this.Lt.launcher&&(r=document.createElement("a"),a[2]=r,r.href="#",r.className="__talkjs_launcher "+(e?"open":"closed"),(e||"close-only"===this.Lt.launcher)&&(r.style.display="none"),r.id="__talkjs_launcher",r.addEventListener("click",(e=>{if(e.preventDefault(),e.target.className.match(/open/)){this.qt(a);const e={};this.Ht.emit("close",e)}else{this.Wt(a);const e={};this.Ht.emit("open",e)}})),o.appendChild(r)),a}rememberMe(){if(!this.Lt.keepOpen)return;let e;e=this.conversation instanceof R||this.conversation instanceof F?this.conversation.id:this.conversation;const t=JSON.stringify({conversationId:e,options:this.Lt});var n,i;n=xe(this.C.appId,this.C.me.id,"v2-"),i=t,document.cookie=`${n}=${i};path=/`}fixPageHeight(e){const t=document.body,n=document.documentElement;this.Qt={Zt:t.style.overflow,tn:t.style.height,nn:t.style.width,sn:t.style.position,rn:window.scrollY,an:window.scrollX,un:n.style.height,cn:n.style.overflow},e.style.top=e.style.left="0px",window.scrollTo(0,0),t.style.height=n.style.height="100%",t.style.width="100%",n.style.overflow=t.style.overflow="hidden",t.style.position="relative"}restorePageHeight(){if(this.Qt){const e=document.body,t=document.documentElement;e.style.overflow=this.Qt.Zt,e.style.width=this.Qt.nn,e.style.height=this.Qt.tn,e.style.position=this.Qt.sn,t.style.height=this.Qt.un,t.style.overflow=this.Qt.cn,window.scrollTo(this.Qt.an,this.Qt.rn)}}forgetMe(){A(xe(this.C.appId,this.C.me.internalId)),A(xe(this.C.appId,this.C.me.id,"v2-"))}}function xe(e,t,n=""){return`talkjs-popup-${n}${t}-${e}`}class Ke extends je{constructor(e,{selectedConversation:t}={},n){super(e,{hideHub:!0,selectedConversation:t},K.a.Chatbox,n)}mount(e){return super.Rt(e)}destroy(){super.destroy()}select(e,t){return t&&void 0!==t.asGuest&&r(t.asGuest,["boolean"],'Chatbox#select: field "asGuest" is given but not a boolean.'),super.select(e,t)}}var Ue=n(6);let Be;Be=n(371).default;let Je={};for(let e in Be)Je[e]=new Ue.a({values:Be[e]});var Le=Je;class He{constructor(e,t,n,i,s){if(this.appId=e,this.userId=t,this.tokenFetcher=i,this.usingBokens=!1,this.requestInProgress=!1,this.eventEmitter=new Z({tokenChanged(e){},tokenRefreshFailed(e){},reconnectPhoenixSockets(e){}}),s&&(n||i))throw new Error("[TalkJS] If providing a signature for authentication, you must not provide a token or tokenFetcher.");n?this.fetchToken((()=>n)):(i||(this.usingBokens=!0,this.tokenFetcher=()=>async function(e,t,n){const i=new b.b([["signature",n]]).toString();return E({method:"GET",url:ue(e,`bokens/${encodeURIComponent(t)}?${i}`),attempts:1}).then((e=>e.json())).then((e=>e.boken))}(e,t,s)),this.refreshToken())}get shouldMountFrontendWithSignature(){return this.usingBokens&&this.requestInProgress}get canRefreshToken(){return this.usingBokens||!!this.tokenFetcher}getToken(){return this.token}refreshToken(){if(!this.requestInProgress){if(!this.tokenFetcher)throw this.emitTokenExpired("no `tokenFetcher` provided"),new Error("[TalkJS] Cannot refresh token, no `tokenFetcher` provided.");this.fetchToken(this.tokenFetcher)}}onTokenChanged(e){return this.eventEmitter.on("tokenChanged",e),()=>{this.eventEmitter.off("tokenChanged",e)}}emitTokenChanged(e){this.eventEmitter.emit("tokenChanged",e);try{!function(e,t){const n=Ye(e),i=n.sub;if("string"==typeof i&&!i.startsWith("t"))return;const s=n.exp;if(!s)return;const o=Math.round((new Date).getTime()/1e3),r=s-o;if(r<=0)console.error("[TalkJS debug] The initial token is already expired. Check your PC's clock is set correctly. See https://talkjs.com/docs/Features/TODO-STEVEN.html for more information on JWT authentication.");else if(r<120&&!t)console.error(`[TalkJS debug] TalkJS will stop working in ${r}s due to the initialToken expiring! You should provide a 'tokenFetcher' function, or use longer-lasting JWTs. We recommend that non-refreshable tokens last at least 24 hours. See https://talkjs.com/docs/Features/TODO-STEVEN.html for more information on JWT authentication.`);else if(r<120&&t)console.warn(`[TalkJS debug] The initial token expires in ${r} seconds. Refreshable JWTs should last at least 10 minutes to improve performance. See https://talkjs.com/docs/Features/TODO-STEVEN.html for more information on JWT authentication.`);else if(r<3300&&!t){const e=Math.round(r/60);console.warn(`[TalkJS debug] The initial token expires in ${e} minutes, and you didn't provide a 'tokenFetcher' function. When the token expires, TalkJS will stop working and users will have to refresh the page. For non-refreshable tokens, we recommend an expiry time of at least 24 hours. See https://talkjs.com/docs/Features/TODO-STEVEN.html for more information on JWT authentication.`)}}(e,!!this.tokenFetcher)}catch(e){}}onTokenRefreshFailed(e){return this.eventEmitter.on("tokenRefreshFailed",e),()=>{this.eventEmitter.off("tokenRefreshFailed",e)}}emitTokenExpired(e){this.eventEmitter.emit("tokenRefreshFailed",e),console.error("[TalkJS] Cannot fetch new authentication token: ",e)}onReconnectPhoenixSockets(e){return this.eventEmitter.on("reconnectPhoenixSockets",e),()=>{this.eventEmitter.off("reconnectPhoenixSockets",e)}}emitReconnectPhoenixSockets(e){this.requestInProgress||this.eventEmitter.emit("reconnectPhoenixSockets",e)}async fetchToken(e){if(this.requestInProgress)return;this.requestInProgress=!0;const t=async()=>{const t=await e();if("string"!=typeof t)throw new Error(`[TalkJS] expected the tokenFetcher to return a string, but got ${typeof t} instead.`);const n=Ye(t);if(!this.usingBokens){const e=n.iss;if(void 0===e)throw new Error(`[TalkJS] Authentication token did not contain 'iss' property in payload. This should be set to your app ID (${this.appId}).`);if(e!==this.appId)throw new Error(`[TalkJS] Authentication token's 'iss' claim (${e}) did not match the specified app ID (${this.appId}).`);const t=n.sub;if(void 0===t)throw new Error(`[TalkJS] Authentication token did not contain 'sub' property in payload. This should be set to your user ID (${this.userId}).`);if(t!==this.userId)throw new Error(`[TalkJS] Authentication token's 'sub' claim (${t}) did not match the specified user ID (${this.userId}).`)}return t};try{const e=void 0!==this.token;this.token=Object(b.j)(3,t,{initialDelay:.2});const n=await this.token;e&&this.emitTokenChanged(n)}catch(e){this.emitTokenExpired(e)}finally{this.requestInProgress=!1}}}function Ye(e){const t=e.split(".");if(3!==t.length)throw new Error("[TalkJS] Token does not contain exactly two `.` - Not a JWT: "+e);try{const e=t[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(e).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join(""));return JSON.parse(n)}catch(t){throw new Error(`[TalkJS] Could not parse JWT payload: ${e}. Error: ${t}`)}}class ze{constructor({appId:e,me:t,token:n,tokenFetcher:i,signature:s}){if(this.L={message:()=>this.Kt.H()},this.Y=new Z({message(e){},desktopNotificationClicked(e){},browserPermissionNeeded(e){},browserPermissionDenied(e){}},this.L),this.hn=[],this.isAlive=!0,this.ve=I(),this.B=e=>{if(this.Y.handles("desktopNotificationClicked"))return void setTimeout((()=>{this.Y.emit("desktopNotificationClicked",{conversation:e})}),0);const t=this.getInboxes();if(1===t.length){t[0].select(e.id)}},this.ln=fe[ze.fn],!this.ln)throw new Error("[TalkJS] Unexpected error at TalkJS startup.");if(!(t instanceof M))throw new Error("[TalkJS] The `me` property in the Session#constructor has to be of type Talk.User. For example:\n\nvar user = new Talk.User(data);\nvar session = new Talk.Session({\n    me: user,\n    appId: ...\n})\n\nFor more information check our documentation https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.constructor");this.appId=r(e,["string"],"Session: required field 'appId' is missing, is not a string or is an empty string.",[h]),r(e,["string"],'Session: You need to replace "YOUR_APP_ID" with the app id found on the dashboard.\n\nFor more information check our documentation https://talkjs.com/docs/Reference/Concepts/Sessions/#appId',[e=>"YOUR_APP_ID"!==e]),this.me=r(t,["object"],"Session: required field 'me' is not given or not a Talk.User object"),r(n,["string","undefined"],"Session: optional field 'token' is not a string.",[h]),r(i,["function","undefined"],"Session: optional field 'tokenFetcher' is not a function."),this.signature=r(s,["string","undefined"],"Session: optional field 'signature' is not a string.",[h]),this.J=new C(this.appId+"."+this.me.id);this.authProvider=new He(this.appId,this.me.id,n,i,s),w.setData({appId:this.appId,meId:this.me.internalId,sessionId:this.ve}),this.R=async function(e,t,n,i){const s=await E({method:"GET",url:ue(t,"app",0),attempts:3,authProvider:e}),o=(await s.json()).appMetadata.defaultLocale;return new ae(e,n,t,o,i)}(this.authProvider,this.appId,this.me,this.ve),this.Kt=new ne(this.R,(e=>this.Y.emit("message",e)),this.B,t.id,this.J),this.unreads=this.Kt,V()&&this.Kt.H(),new ie(this.R,this.ve),this.dn(),this.pn(),this.mn=Ue.a.decide(Le,"en",this.me.locale),this.R.then((e=>e.getNym(this.me.internalId).then((t=>{null!==t&&(t.locale===this.me.locale&&null!==t.locale||(this.mn=Ue.a.decide(Le,e.appLocale,t.locale)))})))).catch((()=>{}))}hasValidCredentials(){return this.M(),this.R.then((()=>!0),(()=>!1))}dn(){const e=N(`talkjs-popup-${this.me.internalId}-${this.appId}`),t=N(`talkjs-popup-v2-${this.me.id}-${this.appId}`);if(e||t){if(t){const{conversationId:e,options:n}=JSON.parse(t);this.createPopup(e,n).mount({show:!0})}if(e){this.createPopup(e).mount({show:!0})}}}pn(){const e=e=>{for(let e of this.hn)e.onWindowVisibleChanged()};window.addEventListener("focus",(()=>e())),window.addEventListener("blur",(()=>e()))}getOrStartConversation(e,{participants:t,topicId:n,subject:i,custom:s,welcomeMessages:o,photoUrl:a}={}){if(this.M(),e instanceof M){const t=e,r=[this.me,t];return this.getOrStartConversation($(this.me,t,n),{participants:r,topicId:n,subject:i,welcomeMessages:o,custom:s,photoUrl:a})}const u=e;r(u,["string"],"conversationId cannot be empty",[h]);let c=(t=t||[]).map((e=>new m(e)));return c=this.vn(c,this.me),new R({conversationId:u,participants:c,topicId:n,subject:i,welcomeMessages:o,custom:s,photoUrl:a})}vn(e,t){let n;return e.filter((e=>e.user.id===this.me.id))[0]?e:(n=new m(this.me),[n,...e])}getOrCreateConversation(e){return this.M(),new F(e,this)}createInbox(e={}){r(e,["object"],"Expected 1st parameter to createInbox, if present, to be an object. More info on https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.createInbox"),r(e.selected,["null","undefined","string","object"],"Expected the createInbox `selected` option, if present, to be a conversation ID, a ConversationBuilder or null. More info on https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.createInbox",[j]),this.M(),e.feedFilter&&_e("feedFilter",e.feedFilter),e.messageFilter&&Se("feedFilter",e.messageFilter);const{selected:t}=e,n=new Fe(this,{selectedConversation:t},e);return this.rememberUIBox(n),n}createChatbox(e,t={}){let n,i;j(e)?(n=e,i=t):(n=void 0,i=null!=e?e:t),r(n,["null","undefined","string","object"],"Expected 1st parameter to createChatbox to be a conversation ID, a ConversationBuilder, null, or undefined. More info on https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.createChatbox",[j]),r(i,["object"],"Expected 2nd parameter to createChatbox, if present, to be an object. More info on https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.createChatbox"),this.M();const s=new Ke(this,{selectedConversation:n},i);return this.rememberUIBox(s),s}createPopup(e,t={}){let n,i;j(e)?(n=e,i=t):(n=void 0,i=null!=e?e:t),r(n,["null","undefined","string","object"],"Expected 1st parameter to createPopup to be a conversation ID, a ConversationBuilder, null, or undefined. More info on https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.createPopup",[j]),r(i,["object"],"Expected 2nd parameter to createPopup, if present, to be an object. More info on https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.createPopup"),this.M();const s={keepOpen:!this.At(4),launcher:this.At(5)?"always":"close-only"};i=Object.assign(Object.assign({},s),i);const o=new $e(this,n,i);return this.rememberUIBox(o),o}rememberUIBox(e){this.hn.push(e)}syncThemeForLocalDev(e){this.M(),b.i(this.appId)?console.warn("[TalkJS]: syncThemeForLocalDev does not work in live mode, please copy your theme to the TalkJS dashboard!"):this.legacyThemePath=e}forgetUIBox(e){const t=this.hn.indexOf(e);t>=0&&this.hn.splice(t,1)}setDesktopNotificationEnabled(e,{alertOnFailure:t}={}){this.M(),e=r(e,["boolean"],"Session.setDesktopNotificationEnabled: isEnabled should be a boolean value.");const n=e=>{this.gn(),this.hn.forEach((t=>t.Ut(e)))};return this.Jt(e,{alertOnFailure:t}).then((()=>n(e))).catch((e=>{throw n(!1),e}))}Jt(e,{alertOnFailure:t,appName:n}){return e&&this.Kt.H(),void 0===t&&(t=!this.Y.handles("browserPermissionDenied")),q(e,{locale:this.mn,emitBrowserPermissionNeeded:()=>this.vt("notifications"),emitBrowserPermissionDenied:()=>this.gt("notifications"),alertOnFailure:t,appName:n})}gn(){this.hn.filter((e=>e.isZombie())).forEach((e=>e.destroy()))}registerDevice({platform:e,pushRegistrationId:t}){return this.M(),e=r(e,["string"],'Session.registerDevice: Platform should be a string containing "ios" or "android" values.',[f]),t=r(t,["string"],"Session.registerDevice: Push registration id should be a not empty string.",[h]),this.clearPushRegistrations().then((()=>this.setPushRegistration({provider:"ios"===e?"apns":"fcm",pushRegistrationId:t})))}unregisterDevice(){return this.clearPushRegistrations()}setPushRegistration({provider:e,pushRegistrationId:t}){return this.M(),e=r(e,["string"],'Session.setPushRegistration: Provider should be a string containing "fcm" or "apns" values.',[d]),t=r(t,["string"],"Session.setPushRegistration: Push registration id should be a not empty string.",[h]),this.R.then((n=>n.put(`/nyms/${this.me.internalId}/push_registration`,{provider:e,pushId:t}))).then((()=>{})).catch((e=>{throw console.error("[TalkJS]","Something went wrong: Cannot register this device.\n\nNote that you must ensure that the user exists in the TalkJS database before you call this method. The simplest way to do that is to call it after you mount a chatbox, inbox or popup."),e}))}unsetPushRegistration({provider:e,pushRegistrationId:t}){return this.M(),e=r(e,["string"],'Session.setPushRegistration: Provider should be a string containing "fcm" or "apns" values.',[d]),t=r(t,["string"],"Session.setPushRegistration: Push registration id should be a not empty string.",[h]),this.R.then((n=>n.delete(`/nyms/${this.me.internalId}/push_registration`,{provider:e,pushId:t}))).then((()=>{})).catch((e=>{throw console.error("[TalkJS]","Cannot unregister this device. Please contact us to get more information."),e}))}clearPushRegistrations(){return this.M(),this.R.then((e=>e.delete(`/nyms/${this.me.internalId}/push_registration`,{provider:null,pushId:null}))).then((()=>{})).catch((e=>{throw console.error("[TalkJS]","Cannot unregister this device. Please contact us to get more information."),e}))}async vt(e){if(!await async function(e){if(!("permissions"in navigator))return!1;const t=e;try{return"prompt"===(await navigator.permissions.query({name:t})).state}catch(e){return!1}}(e))return"continue";let t=!1;const n={type:e,preventDefault(){t=!0}};return await this.Y.emitAsync("browserPermissionNeeded",n),t?"cancel":"continue"}gt(e){return this.Y.emit("browserPermissionDenied",{type:e}),this.Y.handles("browserPermissionDenied")}on(e,t){this.M(),this.Y.on(e,t)}off(e,t){this.Y.off(e,t)}onMessage(e){return this.Y.subscribe("message",e)}onDesktopNotificationClicked(e){return this.Y.subscribe("desktopNotificationClicked",e)}onBrowserPermissionNeeded(e){return k({handler:e}),this.M(),this.Y.subscribe("browserPermissionNeeded",e)}onBrowserPermissionDenied(e){return k({handler:e}),this.M(),this.Y.subscribe("browserPermissionDenied",e)}destroy(){this.isAlive=!1,this.J.relinquish();for(let e of this.hn)e.destroy();this.Kt.pe(),this.Y.removeAllListeners(),this.R.then((e=>e.disconnect()))}getPopups(){return this.Xt(K.a.Popup)}getInboxes(){return this.Xt(K.a.Inbox)}getChatboxes(){return this.Xt(K.a.Chatbox)}Xt(e){return this.gn(),this.hn.filter((t=>t.boxType===e))}M(){if(!this.isAlive)throw new Error("[TalkJS] The Talk.Session instance related to this operation has been destroyed, and it cannot be used anymore. Please create a new Session.")}bn(e){return this.R.then((t=>t.post("/_t",e))).then((e=>e.text()))}At(e){return-1!==this.ln.indexOf(e)}}const We=window;if(We.Talk||(We.Talk={}),ze.fn=We.Talk.v||0,We.Talk.User=M,We.Talk.Session=ze,We.Talk.Error=o,We.Talk.TalkError=o,We.Talk.oneOnOneId=function(e,t){return e instanceof M&&(e=e.id),t instanceof M&&(t=t.id),Object(v.a)(JSON.stringify([e,t].sort()))},We.Talk.getAppMetadata=function(e){return E({method:"GET",url:ue(e,""),attempts:3}).then((e=>e.json())).then((t=>{if(t.custom)return{id:e,custom:t.custom};throw new Error("Unexpected error")}))},We.onTalkLoaded&&We.onTalkLoaded(),We.onTalkUiLoaded&&We.onTalkUiLoaded(),We.Talk.ready){const e=Promise.resolve(),t=We.Talk.ready;t.c.forEach((([t,n,i])=>{e.then(t).then(n).catch(i)})),t.Tn=[],t.then=e.then.bind(e),t.catch=e.catch.bind(e)}},39:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));let i=n(124);function s(e){var t=new i("SHA-1","TEXT");return t.update(e),t.getHash("HEX").substr(0,20)}},42:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var i=n(27);function s(e,t){let n=[];return Object(i.a)(e,((e,i)=>{n.push(t(e,i))})),n}function o(e){return s(e,((e,t)=>[t,e]))}},53:function(e,t,n){"use strict";const i=(()=>{{let t;try{t=window.localStorage;var e="__storage_test__";return t.setItem(e,e),t.removeItem(e),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}}return!1})();var s={};i?(s.setItem=window.localStorage.setItem.bind(window.localStorage),s.getItem=window.localStorage.getItem.bind(window.localStorage),s.removeItem=window.localStorage.removeItem.bind(window.localStorage),s.isSupported=!0):(s.setItem=function(){},s.getItem=function(){return null},s.removeItem=function(){},s.isSupported=!1),s.set=(e,t)=>s.setItem(e,JSON.stringify(t)),s.get=e=>JSON.parse(s.getItem(e)||"null"),t.a=s},55:function(e,t,n){"use strict";function i(e,t){return e.reduce(((e,n,i)=>e.concat(t(n,i))),[])}function s(e,t){return[...e].sort(((e,n)=>{const i=t(e),s=t(n);return i<s?-1:i==s?0:1}))}function o(e,t){let n=[];const i=Math.min(e.length,t.length);for(let s=0;s<i;s++)n[s]=[e[s],t[s]];return n}function r(e,t){let n=[],i=[];for(var s=0;s<e.length;s++)t(e[s])?n.push(e[s]):i.push(e[s]);return[n,i]}n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return r}))},57:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));function i(e,t,n){if(!(t instanceof Array))throw console.error("`params` must be array"),new Error("`params` must be array");r({params:t,method:e,___talkjs:!0},n)}let s=0;function o(e,t,n){return new Promise(((i,o)=>{const u="respond_"+s++;let c={};const h=e=>a(e,{sourceWindow:n,handlers:c}),l=()=>window.removeEventListener("message",h);c[u]=e=>{l(),i(e)},c["error_"+u]=e=>{l(),o(function(e){if(e&&e.__fakeError){const{message:t,stack:n}=e.__fakeError;e=new Error(t),n&&(e.stack=n)}return e}(e))},window.addEventListener("message",h),r({method:e,params:t,responseMethod:u,___talkjs:!0},n)}))}function r(e,t){t.postMessage(e,"*")}function a(e,{sourceWindow:t,handlers:n,prefix:s=""}){if(!e.data||e.data&&"object"!=typeof e.data)return;if(!e.data.___talkjs)return;const o=e.data;if(!o.method||!o.params)return;let r,a=n[s+o.method];if(!a)return;if(t!==e.source)return;try{r=Promise.resolve(a.apply(n,o.params))}catch(e){r=Promise.reject(e)}const c=o.responseMethod;c?r.then((e=>i(c,[e],t)),(e=>i("error_"+c,[u(e)],t))):r.catch((e=>{throw e}))}function u(e){return e&&e.message&&e.stack?{__fakeError:{message:e.message,stack:e.stack}}:e}},6:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(e,t){const n=t?Object.assign(Object.assign({},t.values),e.values):e.values;this.values=n,this.meta=e.meta,this.t=(e,t)=>t?function(e,t){for(let n in t)e=e.replace("$"+n,t[n]);return e}(n[e],t):n[e]}static decide(e,t="en",n){const i=s(e,n);if(i)return i;const o=s(e,t);return o||e.en}}function s(e,t){if(!t)return;const n=e[t=t.replace(/_/g,"-").toLowerCase()];if(n)return n;return e[t.substring(0,2)]}},60:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return r}));var i=n(55);n(42);function s(e,t){let n={};return e.forEach(((e,i)=>{const[s,o]=t(e,i);n[s]=o})),n}function o(e){return s(e,(e=>e))}function r(e,t){return o(Object(i.d)(e,t))}},62:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));const i=Object.create(null);function s(e){e(i)}i.channels=Object.create(null),i.monitors=Object.create(null),window.Talk||(window.dev=i)},67:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h}));var i=n(91),s=n(20),o=n(62),r=n(15);const a=window.WebSocket;class u{constructor(e,t,n){this.On=t,this.ensureValidAuth=n,this.tokenParams={},this.kn=[e,"api","v0",t.appId,"socket"].join("/"),this.wn={}}connect(e={}){this.tokenParams=Object.assign(Object.assign({},this.tokenParams),e);try{this.yn=new i.Socket(this.kn,{params:()=>Object.assign(Object.assign({},this.On),this.tokenParams),transport:a}),this.yn.connect()}catch(e){throw e}}leaveChannel(e){let t;t="string"==typeof e?this.In(e):e.name;this.wn[t].leave(),delete this.wn[t]}disconnect(){this.yn&&(this._n(),this.Sn(this.yn))}async setAuth(e){var t,n;if((this.tokenParams.authToken!==e||!(null===(t=this.yn)||void 0===t?void 0:t.isConnected())&&"connecting"!==(null===(n=this.yn)||void 0===n?void 0:n.connectionState()))&&(this.tokenParams.authToken=e,this.yn)){if(this.yn.isConnected())return this.blueGreenReconnect();this.hardReconnect()}}hardReconnect(){var e;null===(e=this.yn)||void 0===e||e.disconnect((()=>{var e;null===(e=this.yn)||void 0===e||e.connect()}),1e3)}async blueGreenReconnect(){var e;const t=this.yn;this.connect({});const n=Object.values(this.wn).map((e=>e.connect(this.yn,t))),i=Object(r.e)();null===(e=this.yn)||void 0===e||e.onError((()=>{i.resolve()})),await Promise.race([Promise.all(n),i.promise]),this.Sn(t)}isConnected(){var e;return!!(null===(e=this.yn)||void 0===e?void 0:e.isConnected())}_n(){for(const e of Object.values(this.wn))e.leave();this.wn={}}Sn(e){e&&(e.disconnect(void 0,1e3),e.reconnectTimer.reset(),clearInterval(this.yn.heartbeatTimer))}getOrJoin(e,t={},n,i){if(!this.yn)throw new Error("[TalkJS] Socket not connected");const s=this.In(e);let r=this.wn[s];return r||(r=new c(this.yn,s,{initialData:t,onRejoin:n,onJoin:i}),this.wn[s]=r),Object(o.a)((t=>{t.channels[e]=r})),r}In(e){return`${e}:${this.On.appId}`}}class c{constructor(e,t,n){this.name=t,this.startupOptions=n,this.leave=e=>this.phoenixChannel.leave(e),this.on=(e,t)=>this.phoenixChannel.on(e,t),this.push=(e,t,n)=>this.phoenixChannel.push(e,t,n),this.joinRef=()=>this.phoenixChannel.joinRef(),this.connect(e)}connect(e,t){var n;const i=Object(r.e)(),s=this.phoenixChannel,o=null!==(n=null==s?void 0:s.bindings)&&void 0!==n?n:[];this.phoenixChannel=e.channel(this.name,this.startupOptions.initialData),this.phoenixChannel.bindings.push(...o);const a=()=>{if(t&&t.isConnected()){h(s.leave(),this.name).then(i.resolve).catch(i.resolve)}else i.resolve()};let u;return this.phoenixChannel.join().receive("ok",(e=>{var n,i;a();const s=u;if(u=(e||{}).backend_instance_id||"not_implemented",void 0===s)return;const o=s!==u||!!(null==t?void 0:t.isConnected());null===(i=(n=this.startupOptions).onRejoin)||void 0===i||i.call(n,this,o)})).receive("error",(e=>{a()})).receive("timeout",(()=>{a()})),this.startupOptions.onJoin&&!s&&this.startupOptions.onJoin(this),i.promise}}function h(e,t){return new Promise(((n,i)=>{e.receive("ok",(e=>n(e))).receive("error",(e=>e&&e.api_error?i(new s.a(e.api_error)):i(e))).receive("timeout",(()=>{const e=`[TalkJS] Network issues for ${t}.`;console.warn(e),i(e)}))}))}},7:function(e,t,n){"use strict";n.d(t,"d",(function(){return i.a})),n.d(t,"g",(function(){return s})),n.d(t,"i",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return h})),n.d(t,"j",(function(){return f})),n.d(t,"h",(function(){return d})),n.d(t,"f",(function(){return p}));n(42),n(60);var i=n(27);function s(e,t){return d(e,(([e,n])=>[e,t(n,e)]))}function o(e,...t){let n={};return Object(i.a)(e,((e,i)=>{-1===t.indexOf(i)&&(n[i]=e)})),n}function r(e,t){let n={};return Object(i.a)(e,((e,i)=>{t(e,i)&&(n[i]=e)})),n}function a(e,t){for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=[n,e[n]];if(t(e[n],n))return i}}function u(e,t){const n=a(e,t);return n&&n[1]}function c(e){return Object.keys(e).length}function h(e){for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}function l(e,t,n){const[i,...s]=t;if(!i)return n(e);const o=e[i]||(s[0]?{}:void 0);return Object.assign(Object.assign({},e),{[i]:l(o,s,n)})}function f(e,t,n){return l(e,t,(()=>n))}function d(e,t){let n={},s=0;return Object(i.a)(e,((e,i)=>{const[o,r]=t([i,e],s++);n[o]=r})),n}function p(e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype}},71:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r}));const{cdnHost:i,appHost:s,restHost:o,appProtocol:r,appWsProtocol:a}=function(){const e=function(){if(document.currentScript)return document.currentScript.src;try{throw new Error}catch(e){return e.stack.match(/https?:\/\/.*\.js/)[0]}}(),t=document.createElement("a");t.href=e;const n=t.host,i=function(e){if(e.match(/^cdn[\.-]/))return e.replace(/^cdn/,"app");0;return e}(n),s=function(e){if(e.match(/^app[\.-]/))return e.replace(/^app/,"api");return e+"/public_api"}(i),o=t.protocol;return{cdnHost:n,appHost:i,restHost:s,appProtocol:o,appWsProtocol:"https:"===o?"wss:":"ws:"}}()},76:function(e,t,n){"use strict";function i(e){const t="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";let n=0,i=[];const s=e===n;n=e;let o=new Array(8);for(var r=7;r>=0;r--)o[r]=t.charAt(e%64),e=Math.floor(e/64);if(0!==e)throw new Error("We should have converted the entire timestamp.");let a=o.join("");if(s){for(r=11;r>=0&&63===i[r];r--)i[r]=0;i[r]++}else for(var r=0;r<12;r++)i[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)a+=t.charAt(i[r]);if(20!=a.length)throw new Error("Length should be 20.");return a}n.d(t,"a",(function(){return i}))},91:function(e,t,n){e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){(function(t){e.exports=t.Phoenix=n(2)}).call(this,n(1))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,s=!1,o=void 0;try{for(var r,a=e[Symbol.iterator]();!(i=(r=a.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==a.return||a.return()}finally{if(s)throw o}}return n}}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function h(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}n.r(t),n.d(t,"Channel",(function(){return M})),n.d(t,"Serializer",(function(){return j})),n.d(t,"Socket",(function(){return R})),n.d(t,"LongPoll",(function(){return F})),n.d(t,"Ajax",(function(){return $})),n.d(t,"Presence",(function(){return x}));var l="undefined"!=typeof self?self:null,f="undefined"!=typeof window?window:null,d=l||f||void 0,p=0,m=1,v=2,g=3,b="closed",T="errored",O="joined",k="joining",w="leaving",y="phx_close",I="phx_error",_="phx_join",S="phx_reply",E="phx_leave",A=[y,I,_,S,E],N="longpoll",P="websocket",D=function(e){return"function"==typeof e?e:function(){return e}},C=function(){function e(t,n,i,s){u(this,e),this.channel=t,this.event=n,this.payload=i||function(){return{}},this.receivedResp=null,this.timeout=s,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}return h(e,[{key:"resend",value:function(e){this.timeout=e,this.reset(),this.send()}},{key:"send",value:function(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}},{key:"receive",value:function(e,t){return this.hasReceived(e)&&t(this.receivedResp.response),this.recHooks.push({status:e,callback:t}),this}},{key:"reset",value:function(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}},{key:"matchReceive",value:function(e){var t=e.status,n=e.response;e.ref,this.recHooks.filter((function(e){return e.status===t})).forEach((function(e){return e.callback(n)}))}},{key:"cancelRefEvent",value:function(){this.refEvent&&this.channel.off(this.refEvent)}},{key:"cancelTimeout",value:function(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}},{key:"startTimeout",value:function(){var e=this;this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,(function(t){e.cancelRefEvent(),e.cancelTimeout(),e.receivedResp=t,e.matchReceive(t)})),this.timeoutTimer=setTimeout((function(){e.trigger("timeout",{})}),this.timeout)}},{key:"hasReceived",value:function(e){return this.receivedResp&&this.receivedResp.status===e}},{key:"trigger",value:function(e,t){this.channel.trigger(this.refEvent,{status:e,response:t})}}]),e}(),M=function(){function e(t,n,i){var s=this;u(this,e),this.state=b,this.topic=t,this.params=D(n||{}),this.socket=i,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new C(this,_,this.params,this.timeout),this.pushBuffer=[],this.stateChangeRefs=[],this.rejoinTimer=new K((function(){s.socket.isConnected()&&s.rejoin()}),this.socket.rejoinAfterMs),this.stateChangeRefs.push(this.socket.onError((function(){return s.rejoinTimer.reset()}))),this.stateChangeRefs.push(this.socket.onOpen((function(){s.rejoinTimer.reset(),s.isErrored()&&s.rejoin()}))),this.joinPush.receive("ok",(function(){s.state=O,s.rejoinTimer.reset(),s.pushBuffer.forEach((function(e){return e.send()})),s.pushBuffer=[]})),this.joinPush.receive("error",(function(){s.state=T,s.socket.isConnected()&&s.rejoinTimer.scheduleTimeout()})),this.onClose((function(){s.rejoinTimer.reset(),s.socket.hasLogger()&&s.socket.log("channel","close ".concat(s.topic," ").concat(s.joinRef())),s.state=b,s.socket.remove(s)})),this.onError((function(e){s.socket.hasLogger()&&s.socket.log("channel","error ".concat(s.topic),e),s.isJoining()&&s.joinPush.reset(),s.state=T,s.socket.isConnected()&&s.rejoinTimer.scheduleTimeout()})),this.joinPush.receive("timeout",(function(){s.socket.hasLogger()&&s.socket.log("channel","timeout ".concat(s.topic," (").concat(s.joinRef(),")"),s.joinPush.timeout),new C(s,E,D({}),s.timeout).send(),s.state=T,s.joinPush.reset(),s.socket.isConnected()&&s.rejoinTimer.scheduleTimeout()})),this.on(S,(function(e,t){s.trigger(s.replyEventName(t),e)}))}return h(e,[{key:"join",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=e,this.joinedOnce=!0,this.rejoin(),this.joinPush}},{key:"onClose",value:function(e){this.on(y,e)}},{key:"onError",value:function(e){return this.on(I,(function(t){return e(t)}))}},{key:"on",value:function(e,t){var n=this.bindingRef++;return this.bindings.push({event:e,ref:n,callback:t}),n}},{key:"off",value:function(e,t){this.bindings=this.bindings.filter((function(n){return!(n.event===e&&(void 0===t||t===n.ref))}))}},{key:"canPush",value:function(){return this.socket.isConnected()&&this.isJoined()}},{key:"push",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw new Error("tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.join() before pushing events"));var i=new C(this,e,(function(){return t}),n);return this.canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}},{key:"leave",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=w;var n=function(){e.socket.hasLogger()&&e.socket.log("channel","leave ".concat(e.topic)),e.trigger(y,"leave")},i=new C(this,E,D({}),t);return i.receive("ok",(function(){return n()})).receive("timeout",(function(){return n()})),i.send(),this.canPush()||i.trigger("ok",{}),i}},{key:"onMessage",value:function(e,t,n){return t}},{key:"isLifecycleEvent",value:function(e){return A.indexOf(e)>=0}},{key:"isMember",value:function(e,t,n,i){return!(this.topic!==e||i&&i!==this.joinRef()&&this.isLifecycleEvent(t)&&(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:e,event:t,payload:n,joinRef:i}),1))}},{key:"joinRef",value:function(){return this.joinPush.ref}},{key:"rejoin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=k,this.joinPush.resend(e))}},{key:"trigger",value:function(e,t,n,i){var s=this.onMessage(e,t,n,i);if(t&&!s)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");for(var o=this.bindings.filter((function(t){return t.event===e})),r=0;r<o.length;r++)o[r].callback(s,n,i||this.joinRef())}},{key:"replyEventName",value:function(e){return"chan_reply_".concat(e)}},{key:"isClosed",value:function(){return this.state===b}},{key:"isErrored",value:function(){return this.state===T}},{key:"isJoined",value:function(){return this.state===O}},{key:"isJoining",value:function(){return this.state===k}},{key:"isLeaving",value:function(){return this.state===w}}]),e}(),j={HEADER_LENGTH:1,META_LENGTH:4,KINDS:{push:0,reply:1,broadcast:2},encode:function(e,t){if(e.payload.constructor===ArrayBuffer)return t(this.binaryEncode(e));var n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))},decode:function(e,t){if(e.constructor===ArrayBuffer)return t(this.binaryDecode(e));var n=o(JSON.parse(e),5);return t({join_ref:n[0],ref:n[1],topic:n[2],event:n[3],payload:n[4]})},binaryEncode:function(e){var t=e.join_ref,n=e.ref,i=e.event,s=e.topic,o=e.payload,r=this.META_LENGTH+t.length+n.length+s.length+i.length,a=new ArrayBuffer(this.HEADER_LENGTH+r),u=new DataView(a),c=0;u.setUint8(c++,this.KINDS.push),u.setUint8(c++,t.length),u.setUint8(c++,n.length),u.setUint8(c++,s.length),u.setUint8(c++,i.length),Array.from(t,(function(e){return u.setUint8(c++,e.charCodeAt(0))})),Array.from(n,(function(e){return u.setUint8(c++,e.charCodeAt(0))})),Array.from(s,(function(e){return u.setUint8(c++,e.charCodeAt(0))})),Array.from(i,(function(e){return u.setUint8(c++,e.charCodeAt(0))}));var h=new Uint8Array(a.byteLength+o.byteLength);return h.set(new Uint8Array(a),0),h.set(new Uint8Array(o),a.byteLength),h.buffer},binaryDecode:function(e){var t=new DataView(e),n=t.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.push:return this.decodePush(e,t,i);case this.KINDS.reply:return this.decodeReply(e,t,i);case this.KINDS.broadcast:return this.decodeBroadcast(e,t,i)}},decodePush:function(e,t,n){var i=t.getUint8(1),s=t.getUint8(2),o=t.getUint8(3),r=this.HEADER_LENGTH+this.META_LENGTH-1,a=n.decode(e.slice(r,r+i));r+=i;var u=n.decode(e.slice(r,r+s));r+=s;var c=n.decode(e.slice(r,r+o));return r+=o,{join_ref:a,ref:null,topic:u,event:c,payload:e.slice(r,e.byteLength)}},decodeReply:function(e,t,n){var i=t.getUint8(1),s=t.getUint8(2),o=t.getUint8(3),r=t.getUint8(4),a=this.HEADER_LENGTH+this.META_LENGTH,u=n.decode(e.slice(a,a+i));a+=i;var c=n.decode(e.slice(a,a+s));a+=s;var h=n.decode(e.slice(a,a+o));a+=o;var l=n.decode(e.slice(a,a+r));a+=r;var f=e.slice(a,e.byteLength);return{join_ref:u,ref:c,topic:h,event:S,payload:{status:l,response:f}}},decodeBroadcast:function(e,t,n){var i=t.getUint8(1),s=t.getUint8(2),o=this.HEADER_LENGTH+2,r=n.decode(e.slice(o,o+i));o+=i;var a=n.decode(e.slice(o,o+s));return o+=s,{join_ref:null,ref:null,topic:r,event:a,payload:e.slice(o,e.byteLength)}}},R=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};u(this,e),this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=i.timeout||1e4,this.transport=i.transport||d.WebSocket||F,this.defaultEncoder=j.encode.bind(j),this.defaultDecoder=j.decode.bind(j),this.closeWasClean=!1,this.unloaded=!1,this.binaryType=i.binaryType||"arraybuffer",this.transport!==F?(this.encode=i.encode||this.defaultEncoder,this.decode=i.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder),f&&f.addEventListener&&f.addEventListener("unload",(function(e){n.conn&&(n.unloaded=!0,n.abnormalClose("unloaded"))})),this.heartbeatIntervalMs=i.heartbeatIntervalMs||3e4,this.rejoinAfterMs=function(e){return i.rejoinAfterMs?i.rejoinAfterMs(e):[1e3,2e3,5e3][e-1]||1e4},this.reconnectAfterMs=function(e){return n.unloaded?100:i.reconnectAfterMs?i.reconnectAfterMs(e):[10,50,100,150,200,250,500,1e3,2e3][e-1]||5e3},this.logger=i.logger||null,this.longpollerTimeout=i.longpollerTimeout||2e4,this.params=D(i.params||{}),this.endPoint="".concat(t,"/").concat(P),this.vsn=i.vsn||"2.0.0",this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new K((function(){n.teardown((function(){return n.connect()}))}),this.reconnectAfterMs)}return h(e,[{key:"protocol",value:function(){return location.protocol.match(/^https/)?"wss":"ws"}},{key:"endPointURL",value:function(){var e=$.appendParams($.appendParams(this.endPoint,this.params()),{vsn:this.vsn});return"/"!==e.charAt(0)?e:"/"===e.charAt(1)?"".concat(this.protocol(),":").concat(e):"".concat(this.protocol(),"://").concat(location.host).concat(e)}},{key:"disconnect",value:function(e,t,n){this.closeWasClean=!0,this.reconnectTimer.reset(),this.teardown(e,t,n)}},{key:"connect",value:function(e){var t=this;e&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=D(e)),this.conn||(this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=function(){return t.onConnOpen()},this.conn.onerror=function(e){return t.onConnError(e)},this.conn.onmessage=function(e){return t.onConnMessage(e)},this.conn.onclose=function(e){return t.onConnClose(e)})}},{key:"log",value:function(e,t,n){this.logger(e,t,n)}},{key:"hasLogger",value:function(){return null!==this.logger}},{key:"onOpen",value:function(e){var t=this.makeRef();return this.stateChangeCallbacks.open.push([t,e]),t}},{key:"onClose",value:function(e){var t=this.makeRef();return this.stateChangeCallbacks.close.push([t,e]),t}},{key:"onError",value:function(e){var t=this.makeRef();return this.stateChangeCallbacks.error.push([t,e]),t}},{key:"onMessage",value:function(e){var t=this.makeRef();return this.stateChangeCallbacks.message.push([t,e]),t}},{key:"onConnOpen",value:function(){this.hasLogger()&&this.log("transport","connected to ".concat(this.endPointURL())),this.unloaded=!1,this.closeWasClean=!1,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach((function(e){return(0,o(e,2)[1])()}))}},{key:"resetHeartbeat",value:function(){var e=this;this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((function(){return e.sendHeartbeat()}),this.heartbeatIntervalMs))}},{key:"teardown",value:function(e,t,n){var i=this;if(!this.conn)return e&&e();this.waitForBufferDone((function(){i.conn&&(t?i.conn.close(t,n||""):i.conn.close()),i.waitForSocketClosed((function(){i.conn&&(i.conn.onclose=function(){},i.conn=null),e&&e()}))}))}},{key:"waitForBufferDone",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;5!==n&&this.conn&&this.conn.bufferedAmount?setTimeout((function(){t.waitForBufferDone(e,n+1)}),150*n):e()}},{key:"waitForSocketClosed",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;5!==n&&this.conn&&this.conn.readyState!==g?setTimeout((function(){t.waitForSocketClosed(e,n+1)}),150*n):e()}},{key:"onConnClose",value:function(e){this.hasLogger()&&this.log("transport","close",e),this.triggerChanError(),clearInterval(this.heartbeatTimer),this.closeWasClean||this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((function(t){return(0,o(t,2)[1])(e)}))}},{key:"onConnError",value:function(e){this.hasLogger()&&this.log("transport",e),this.triggerChanError(),this.stateChangeCallbacks.error.forEach((function(t){return(0,o(t,2)[1])(e)}))}},{key:"triggerChanError",value:function(){this.channels.forEach((function(e){e.isErrored()||e.isLeaving()||e.isClosed()||e.trigger(I)}))}},{key:"connectionState",value:function(){switch(this.conn&&this.conn.readyState){case p:return"connecting";case m:return"open";case v:return"closing";default:return"closed"}}},{key:"isConnected",value:function(){return"open"===this.connectionState()}},{key:"remove",value:function(e){this.off(e.stateChangeRefs),this.channels=this.channels.filter((function(t){return t.joinRef()!==e.joinRef()}))}},{key:"off",value:function(e){for(var t in this.stateChangeCallbacks)this.stateChangeCallbacks[t]=this.stateChangeCallbacks[t].filter((function(t){var n=o(t,1)[0];return-1===e.indexOf(n)}))}},{key:"channel",value:function(e){var t=new M(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},this);return this.channels.push(t),t}},{key:"push",value:function(e){var t=this;if(this.hasLogger()){var n=e.topic,i=e.event,s=e.payload,o=e.ref,r=e.join_ref;this.log("push","".concat(n," ").concat(i," (").concat(r,", ").concat(o,")"),s)}this.isConnected()?this.encode(e,(function(e){return t.conn.send(e)})):this.sendBuffer.push((function(){return t.encode(e,(function(e){return t.conn.send(e)}))}))}},{key:"makeRef",value:function(){var e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}},{key:"sendHeartbeat",value:function(){if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void this.abnormalClose("heartbeat timeout");this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef})}}},{key:"abnormalClose",value:function(e){this.closeWasClean=!1,this.conn.readyState===m&&this.conn.close(1e3,e)}},{key:"flushSendBuffer",value:function(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((function(e){return e()})),this.sendBuffer=[])}},{key:"onConnMessage",value:function(e){var t=this;this.decode(e.data,(function(e){var n=e.topic,i=e.event,s=e.payload,r=e.ref,a=e.join_ref;r&&r===t.pendingHeartbeatRef&&(t.pendingHeartbeatRef=null),t.hasLogger()&&t.log("receive","".concat(s.status||""," ").concat(n," ").concat(i," ").concat(r&&"("+r+")"||""),s);for(var u=0;u<t.channels.length;u++){var c=t.channels[u];c.isMember(n,i,s,a)&&c.trigger(i,s,r,a)}for(var h=0;h<t.stateChangeCallbacks.message.length;h++)(0,o(t.stateChangeCallbacks.message[h],2)[1])(e)}))}},{key:"leaveOpenTopic",value:function(e){var t=this.channels.find((function(t){return t.topic===e&&(t.isJoined()||t.isJoining())}));t&&(this.hasLogger()&&this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.leave())}}]),e}(),F=function(){function e(t){u(this,e),this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(t),this.readyState=p,this.poll()}return h(e,[{key:"normalizeEndpoint",value:function(e){return e.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+P),"$1/"+N)}},{key:"endpointURL",value:function(){return $.appendParams(this.pollEndpoint,{token:this.token})}},{key:"closeAndRetry",value:function(){this.close(),this.readyState=p}},{key:"ontimeout",value:function(){this.onerror("timeout"),this.closeAndRetry()}},{key:"poll",value:function(){var e=this;this.readyState!==m&&this.readyState!==p||$.request("GET",this.endpointURL(),"application/json",null,this.timeout,this.ontimeout.bind(this),(function(t){if(t){var n=t.status,i=t.token,s=t.messages;e.token=i}else n=0;switch(n){case 200:s.forEach((function(t){return e.onmessage({data:t})})),e.poll();break;case 204:e.poll();break;case 410:e.readyState=m,e.onopen(),e.poll();break;case 403:e.onerror(),e.close();break;case 0:case 500:e.onerror(),e.closeAndRetry();break;default:throw new Error("unhandled poll status ".concat(n))}}))}},{key:"send",value:function(e){var t=this;$.request("POST",this.endpointURL(),"application/json",e,this.timeout,this.onerror.bind(this,"timeout"),(function(e){e&&200===e.status||(t.onerror(e&&e.status),t.closeAndRetry())}))}},{key:"close",value:function(e,t){this.readyState=g,this.onclose()}}]),e}(),$=function(){function e(){u(this,e)}return h(e,null,[{key:"request",value:function(e,t,n,i,s,o,r){if(d.XDomainRequest){var a=new XDomainRequest;this.xdomainRequest(a,e,t,i,s,o,r)}else{var u=new d.XMLHttpRequest;this.xhrRequest(u,e,t,n,i,s,o,r)}}},{key:"xdomainRequest",value:function(e,t,n,i,s,o,r){var a=this;e.timeout=s,e.open(t,n),e.onload=function(){var t=a.parseJSON(e.responseText);r&&r(t)},o&&(e.ontimeout=o),e.onprogress=function(){},e.send(i)}},{key:"xhrRequest",value:function(e,t,n,i,s,o,r,a){var u=this;e.open(t,n,!0),e.timeout=o,e.setRequestHeader("Content-Type",i),e.onerror=function(){a&&a(null)},e.onreadystatechange=function(){if(e.readyState===u.states.complete&&a){var t=u.parseJSON(e.responseText);a(t)}},r&&(e.ontimeout=r),e.send(s)}},{key:"parseJSON",value:function(e){if(!e||""===e)return null;try{return JSON.parse(e)}catch(t){return console&&console.log("failed to parse JSON response",e),null}}},{key:"serialize",value:function(e,t){var n=[];for(var i in e)if(e.hasOwnProperty(i)){var o=t?"".concat(t,"[").concat(i,"]"):i,r=e[i];"object"===s(r)?n.push(this.serialize(r,o)):n.push(encodeURIComponent(o)+"="+encodeURIComponent(r))}return n.join("&")}},{key:"appendParams",value:function(e,t){if(0===Object.keys(t).length)return e;var n=e.match(/\?/)?"&":"?";return"".concat(e).concat(n).concat(this.serialize(t))}}]),e}();$.states={complete:4};var x=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};u(this,e);var s=i.events||{state:"presence_state",diff:"presence_diff"};this.state={},this.pendingDiffs=[],this.channel=t,this.joinRef=null,this.caller={onJoin:function(){},onLeave:function(){},onSync:function(){}},this.channel.on(s.state,(function(t){var i=n.caller,s=i.onJoin,o=i.onLeave,r=i.onSync;n.joinRef=n.channel.joinRef(),n.state=e.syncState(n.state,t,s,o),n.pendingDiffs.forEach((function(t){n.state=e.syncDiff(n.state,t,s,o)})),n.pendingDiffs=[],r()})),this.channel.on(s.diff,(function(t){var i=n.caller,s=i.onJoin,o=i.onLeave,r=i.onSync;n.inPendingSyncState()?n.pendingDiffs.push(t):(n.state=e.syncDiff(n.state,t,s,o),r())}))}return h(e,[{key:"onJoin",value:function(e){this.caller.onJoin=e}},{key:"onLeave",value:function(e){this.caller.onLeave=e}},{key:"onSync",value:function(e){this.caller.onSync=e}},{key:"list",value:function(t){return e.list(this.state,t)}},{key:"inPendingSyncState",value:function(){return!this.joinRef||this.joinRef!==this.channel.joinRef()}}],[{key:"syncState",value:function(e,t,n,i){var s=this,o=this.clone(e),r={},a={};return this.map(o,(function(e,n){t[e]||(a[e]=n)})),this.map(t,(function(e,t){var n=o[e];if(n){var i=t.metas.map((function(e){return e.phx_ref})),u=n.metas.map((function(e){return e.phx_ref})),c=t.metas.filter((function(e){return u.indexOf(e.phx_ref)<0})),h=n.metas.filter((function(e){return i.indexOf(e.phx_ref)<0}));c.length>0&&(r[e]=t,r[e].metas=c),h.length>0&&(a[e]=s.clone(n),a[e].metas=h)}else r[e]=t})),this.syncDiff(o,{joins:r,leaves:a},n,i)}},{key:"syncDiff",value:function(e,t,n,s){var o=t.joins,r=t.leaves,a=this.clone(e);return n||(n=function(){}),s||(s=function(){}),this.map(o,(function(e,t){var s=a[e];if(a[e]=t,s){var o,r=a[e].metas.map((function(e){return e.phx_ref})),u=s.metas.filter((function(e){return r.indexOf(e.phx_ref)<0}));(o=a[e].metas).unshift.apply(o,i(u))}n(e,s,t)})),this.map(r,(function(e,t){var n=a[e];if(n){var i=t.metas.map((function(e){return e.phx_ref}));n.metas=n.metas.filter((function(e){return i.indexOf(e.phx_ref)<0})),s(e,n,t),0===n.metas.length&&delete a[e]}})),a}},{key:"list",value:function(e,t){return t||(t=function(e,t){return t}),this.map(e,(function(e,n){return t(e,n)}))}},{key:"map",value:function(e,t){return Object.getOwnPropertyNames(e).map((function(n){return t(n,e[n])}))}},{key:"clone",value:function(e){return JSON.parse(JSON.stringify(e))}}]),e}(),K=function(){function e(t,n){u(this,e),this.callback=t,this.timerCalc=n,this.timer=null,this.tries=0}return h(e,[{key:"reset",value:function(){this.tries=0,clearTimeout(this.timer)}},{key:"scheduleTimeout",value:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.tries=e.tries+1,e.callback()}),this.timerCalc(this.tries+1))}}]),e}()}])}});